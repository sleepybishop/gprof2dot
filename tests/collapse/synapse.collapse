_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allHeadersReceived (twisted/web/http.py:2327);getRawHeaders (twisted/web/http_headers.py:266);_encodeName (twisted/web/http_headers.py:114) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:880) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);addBoth (twisted/internet/defer.py:345) 1
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:131);get_resource_usage (synapse/logging/context.py:425);get_thread_resource_usage (synapse/logging/context.py:55) 1
ephemeral_by_room (synapse/handlers/sync.py:417) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:505);new_transaction (synapse/storage/database.py:418);_fetch_event_rows (synapse/storage/data_stores/main/events_worker.py:765);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 12
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:171);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);get_user_filter (synapse/api/filtering.py:145);__init__ (synapse/api/filtering.py:189);__init__ (synapse/api/filtering.py:273) 1
__iter__ (_collections_abc.py:762);__getitem__ (frozendict/__init__.py:29) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);timeout (twisted/internet/base.py:871);_insertNewDelayedCalls (twisted/internet/base.py:841);activate_delay (twisted/internet/base.py:152) 1
<genexpr> (synapse/visibility.py:81);event_id (synapse/events/__init__.py:470);encode_base64 (unpaddedbase64.py:26) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2153);headerReceived (twisted/web/http.py:2255) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1033) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1477) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 4
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:296);iterencode (simplejson/encoder.py:378) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159) 1
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);unwindGenerator (twisted/internet/defer.py:1613) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:220);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:200) 1
generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);gatherResults (twisted/internet/defer.py:1181);__init__ (twisted/internet/defer.py:1099);addCallbacks (twisted/internet/defer.py:311);_runCallbacks (twisted/internet/defer.py:630);_cbDeferred (twisted/internet/defer.py:1121) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2125);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);__exit__ (synapse/logging/context.py:544);set_current_context (synapse/logging/context.py:573) 1
_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);concurrently_execute (synapse/util/async_helpers.py:168);addErrback (twisted/internet/defer.py:333);addCallbacks (twisted/internet/defer.py:311);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:236);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:304);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);wrapped (synapse/util/caches/descriptors.py:563);getcallargs (inspect.py:1351) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2103);__init__ (synapse/http/site.py:312);__init__ (synapse/http/site.py:72);__init__ (twisted/web/server.py:120);__init__ (twisted/web/http.py:770);getHost (twisted/web/http.py:2527);getHost (twisted/internet/tcp.py:885);__init__ (<attrs generated init twisted.internet.address.IPv4Address>:6) 1
new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);callback (synapse/util/async_helpers.py:71);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 10
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1419) 3
encode_room (synapse/rest/client/v2_alpha/sync.py:421);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:189);<listcomp> (synapse/util/async_helpers.py:186);run_in_background (synapse/logging/context.py:655);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);serialize_event (synapse/events/utils.py:359);event_id (synapse/events/__init__.py:466);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/receipts.py:241);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/receipts.py:241);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);new_transaction (synapse/storage/database.py:503);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_many_txn (synapse/storage/database.py:1201);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 10
new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:951);_wrapped (synapse/util/caches/descriptors.py:447);get (synapse/util/caches/descriptors.py:160);get (synapse/util/caches/treecache.py:37) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:447);get_instance (synapse/util/caches/descriptors.py:659);setdefault (weakref.py:288) 1
_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);__iter__ (twisted/internet/defer.py:732) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_have_rooms_changed (synapse/handlers/sync.py:1479);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:69) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 6
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:459);update_metrics (synapse/metrics/background_process_metrics.py:162);labels (prometheus_client/metrics.py:162) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:152);sample_line (synapse/metrics/_exposition.py:79) 2
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1482) 1
get_state_ids_for_event (synapse/storage/state.py:526);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403);reset (synapse/logging/context.py:128) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);time_it_out (synapse/util/async_helpers.py:461);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:630) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2260);getRawHeaders (twisted/web/http_headers.py:266) 1
get_new_events (synapse/handlers/receipts.py:144);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 7
get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:315);get_entities_changed (synapse/util/caches/stream_change_cache.py:97);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135);islice (sortedcontainers/sortedlist.py:993);_pos (sortedcontainers/sortedlist.py:688) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2485);writeSequence (twisted/internet/_newtls.py:204);writeSequence (twisted/internet/abstract.py:384);_maybePauseProducer (twisted/internet/abstract.py:337);_isSendBufferFull (twisted/internet/abstract.py:324) 2
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_paginate_room_events_txn (synapse/storage/data_stores/main/stream.py:928);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_paginate_room_events_txn (synapse/storage/data_stores/main/stream.py:928);untilConcludes (twisted/python/util.py:815);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:231);unquote_to_bytes (urllib/parse.py:596) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:156);labels (prometheus_client/metrics.py:151) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:184);labels (prometheus_client/metrics.py:151) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_set_context_cb (synapse/logging/context.py:719);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:393) 1
process_and_notify (synapse/app/generic_worker.py:742);on_new_event (synapse/notifier.py:307);__exit__ (synapse/util/metrics.py:135);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:415);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);start (synapse/logging/context.py:362) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:708);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:109);__enter__ (synapse/logging/context.py:531);set_current_context (synapse/logging/context.py:573);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1399);unwindGenerator (twisted/internet/defer.py:1613) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:152);sample_line (synapse/metrics/_exposition.py:71) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 7
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);_runCallbacks (twisted/internet/defer.py:711);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);new_transaction (synapse/storage/database.py:503);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_token (synapse/streams/events.py:45) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2122) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);copy (copy.py:76) 1
_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:352);new_listener (synapse/notifier.py:140);is_after (synapse/types.py:389) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:630) 1
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1278);have_push_rules_changed_for_user (synapse/storage/data_stores/main/push_rule.py:138) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1419) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1169);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:136);bisect_right (sortedcontainers/sortedlist.py:1215);_loc (sortedcontainers/sortedlist.py:594) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:236);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:501) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:218);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);start (twisted/web/static.py:765);registerProducer (twisted/web/http.py:987) 1
get_new_events (synapse/handlers/receipts.py:144);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);wrapped (synapse/util/caches/descriptors.py:533) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167) 3
_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:651);prefill (synapse/util/caches/descriptors.py:225);inner (synapse/util/caches/lrucache.py:97);cache_set (synapse/util/caches/lrucache.py:190) 2
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1278);get_updated_account_data_for_user (synapse/storage/data_stores/main/account_data.py:254);succeed (twisted/internet/defer.py:89) 1
_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1422) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:218) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:310);__enter__ (synapse/util/metrics.py:114);register (synapse/metrics/__init__.py:151) 1
_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:300);iterencode (simplejson/encoder.py:378) 1
_generate_sync_entry_for_to_device (synapse/handlers/sync.py:1225);copy_and_replace (synapse/types.py:409) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);get (synapse/util/caches/dictionary_cache.py:89) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);callHandlers (logging/__init__.py:1603);handle (logging/__init__.py:908) 1
_ctx_manager (synapse/util/async_helpers.py:270);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);cancel_timeout (synapse/util/async_helpers.py:477);cancel (twisted/internet/base.py:105) 1
wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:655);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:652) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:230) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (prometheus_client/metrics.py:72);_multi_samples (prometheus_client/metrics.py:187) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);get_membership_changes_for_user (synapse/storage/data_stores/main/stream.py:434) 1
on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:697);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:102);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);_have_rooms_changed (synapse/handlers/sync.py:1478) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:268);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1034);format (logging/__init__.py:880);format (logging/__init__.py:619);usesTime (logging/__init__.py:588);usesTime (logging/__init__.py:430) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 45
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:616);wrapped_async_request_handler (synapse/http/server.py:209);ephemeral_by_room (synapse/handlers/sync.py:417);__exit__ (synapse/util/metrics.py:135);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1412) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:81);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:84) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);run_in_background (synapse/logging/context.py:674);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:320) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:316) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:161);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:663) 1
process_and_notify (synapse/app/generic_worker.py:742);on_new_room_event (synapse/notifier.py:240);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:307);time_msec (synapse/util/__init__.py:59) 1
_have_rooms_changed (synapse/handlers/sync.py:1480);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:77);inc_hits (synapse/util/caches/__init__.py:84) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1399);unwindGenerator (twisted/internet/defer.py:1613) 1
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/receipts.py:241);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/receipts.py:241);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);ensureDeferred (twisted/internet/defer.py:911);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1465);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:268);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1038);flush (logging/__init__.py:1020) 1
unread_notifs_for_room_id (synapse/handlers/sync.py:953);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159);get (synapse/util/caches/treecache.py:38) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);simple_select_onecol_txn (synapse/storage/database.py:1053);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 1
_have_rooms_changed (synapse/handlers/sync.py:1479);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:82);inc_hits (synapse/util/caches/__init__.py:84) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1156);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:545) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:162) 2
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);_runCallbacks (twisted/internet/defer.py:711);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);new_transaction (synapse/storage/database.py:503);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);untilConcludes (twisted/python/util.py:815);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);queue (synapse/util/async_helpers.py:273);contextmanager (contextlib.py:240);update_wrapper (functools.py:65) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doWrite (twisted/internet/abstract.py:271);stopWriting (twisted/internet/abstract.py:430);removeWriter (twisted/internet/epollreactor.py:183);_remove (twisted/internet/epollreactor.py:156) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:977) 1
_get_appservice_user_id (synapse/api/auth.py:259);get_app_service_by_token (synapse/storage/data_stores/main/appservice.py:98) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);headerReceived (twisted/web/http.py:2260);setRawHeaders (twisted/web/http_headers.py:222);_encodeName (twisted/web/http_headers.py:114) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);__init__ (synapse/http/site.py:312);__init__ (synapse/http/site.py:72);__init__ (twisted/web/server.py:119);__init__ (twisted/web/http.py:759);getPeer (twisted/web/http.py:2518);getPeer (twisted/internet/tcp.py:894) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_user_by_req (synapse/api/auth.py:186) 1
iter_errors (jsonschema/validators.py:341);anyOf (jsonschema/_validators.py:329) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1845);_load_filtered_recents (synapse/handlers/sync.py:536);__exit__ (synapse/util/metrics.py:130);labels (prometheus_client/metrics.py:153) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1169);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inc_hits (synapse/util/caches/__init__.py:84) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:251) 12
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:655) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 20
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);_have_rooms_changed (synapse/handlers/sync.py:1478) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798);requestDone (twisted/web/http.py:2397);setTimeout (twisted/protocols/policies.py:739);callLater (twisted/internet/base.py:795);__init__ (twisted/internet/base.py:77) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:226);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:551);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568) 1
_generate_sync_entry_for_to_device (synapse/handlers/sync.py:1225);_trace_inner (synapse/logging/opentracing.py:706);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);delete_messages_for_device (synapse/storage/data_stores/main/deviceinbox.py:90) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:476);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:296);iterencode (simplejson/encoder.py:378) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:1416);_accept (twisted/internet/tcp.py:1193);accept (socket.py:212) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_state_groups_from_groups_txn (synapse/storage/data_stores/state/bg_updates.py:126) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doWrite (twisted/internet/abstract.py:290);writeSomeData (twisted/internet/tcp.py:275);untilConcludes (twisted/python/util.py:815) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:630);convert_cancelled (synapse/util/async_helpers.py:468);_cancelled_to_timed_out_error (synapse/util/async_helpers.py:415);trap (twisted/python/failure.py:463);check (twisted/python/failure.py:479);qual (twisted/python/reflect.py:367) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:630) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 6
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:374);__enter__ (synapse/util/metrics.py:109) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1419) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);insert_client_ip (synapse/replication/slave/storage/client_ips.py:48);send_user_ip (synapse/replication/tcp/handler.py:489);send_command (synapse/replication/tcp/handler.py:437);send_command (synapse/replication/tcp/protocol.py:313);sendLine (twisted/protocols/basic.py:476);writeSequence (twisted/internet/_newtls.py:204);writeSequence (twisted/internet/abstract.py:384);startWriting (twisted/internet/abstract.py:443);addWriter (twisted/internet/epollreactor.py:127);_add (twisted/internet/epollreactor.py:94) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:179);sample_line (synapse/metrics/_exposition.py:90) 2
on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:704);on_new_event (synapse/notifier.py:307);__exit__ (synapse/util/metrics.py:123) 1
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1278);have_push_rules_changed_for_user (synapse/storage/data_stores/main/push_rule.py:139);has_entity_changed (synapse/util/caches/stream_change_cache.py:75) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);get_user_by_req (synapse/api/auth.py:248) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:657);on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121);process_replication_rows (synapse/replication/slave/storage/room.py:42);process_replication_rows (synapse/replication/slave/storage/presence.py:60);process_replication_rows (synapse/replication/slave/storage/_base.py:84);_invalidate_state_caches (synapse/storage/_base.py:63);_attempt_to_invalidate_cache (synapse/storage/_base.py:84);<lambda> (synapse/util/caches/descriptors.py:464);invalidate (synapse/util/caches/descriptors.py:229);inner (synapse/util/caches/lrucache.py:97);cache_pop (synapse/util/caches/lrucache.py:206);delete_node (synapse/util/caches/lrucache.py:149);invalidate (synapse/util/caches/descriptors.py:646);invalidate (synapse/util/caches/descriptors.py:229) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 9
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:777);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:242);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);__exit__ (contextlib.py:119);_ctx_manager (synapse/util/async_helpers.py:266);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:628) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:157);__sub__ (synapse/logging/context.py:175) 1
_generate_sync_entry_for_groups (synapse/handlers/sync.py:1098);get_groups_changes_for_user (synapse/storage/data_stores/main/group_server.py:441);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);run_in_background (synapse/logging/context.py:674);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1416) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:629);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 4
_look_up_user_by_access_token (synapse/api/auth.py:483);from_string (synapse/types.py:179) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:220);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);inc (prometheus_client/metrics.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2475) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:151) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);simple_select_one_onecol_txn (synapse/storage/database.py:1036);simple_select_onecol_txn (synapse/storage/database.py:1053);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 3
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121);process_replication_rows (synapse/replication/slave/storage/room.py:42) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2153);headerReceived (twisted/web/http.py:2260);setRawHeaders (twisted/web/http_headers.py:222);_encodeValues (twisted/web/http_headers.py:147);_encodeValue (twisted/web/http_headers.py:129) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:131);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);makeRecord (logging/__init__.py:1494);__init__ (logging/__init__.py:363);splitext (posixpath.py:129);_splitext (genericpath.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2125);resetTimeout (twisted/protocols/policies.py:713) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:263);_insert_into_cache (synapse/storage/data_stores/state/store.py:352) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_concurrently_execute_inner (synapse/util/async_helpers.py:156);handle_room_entries (synapse/handlers/sync.py:1419) 1
on_RDATA (synapse/replication/tcp/handler.py:281);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:908);emit (sentry_sdk/integrations/logging.py:227);_emit (sentry_sdk/integrations/logging.py:235);_breadcrumb_from_record (sentry_sdk/integrations/logging.py:103) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);send (twisted/internet/defer.py:751) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1496);to_string (synapse/types.py:195) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1665) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);__exit__ (synapse/logging/context.py:535) 1
get_new_events (synapse/handlers/receipts.py:144);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345) 1
encode_room (synapse/rest/client/v2_alpha/sync.py:421);send (twisted/internet/defer.py:751) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);filter_state (synapse/storage/state.py:254) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 5
delete_messages_for_device (synapse/storage/data_stores/main/deviceinbox.py:101);get (synapse/util/caches/expiringcache.py:127);__getitem__ (synapse/util/caches/expiringcache.py:96) 2
get_user_by_access_token (synapse/api/auth.py:313);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_look_up_user_by_access_token (synapse/api/auth.py:477);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 8
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);_started_processing (synapse/http/site.py:239);start (synapse/http/request_metrics.py:160);get_resource_usage (synapse/logging/context.py:425) 2
_look_up_user_by_access_token (synapse/api/auth.py:483);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:155) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);addBoth (twisted/internet/defer.py:345) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:627);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:263);_insert_into_cache (synapse/storage/data_stores/state/store.py:338);get_member_split (synapse/storage/state.py:320) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);ref (jsonschema/_validators.py:266);iter_errors (jsonschema/validators.py:341);iter_errors (jsonschema/validators.py:341);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);ref (jsonschema/_validators.py:266);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:328) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:708);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);remove (synapse/util/async_helpers.py:103) 1
_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1467);_get_state_for_groups (synapse/storage/data_stores/state/store.py:227);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:328) 1
enum (jsonschema/_validators.py:249) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:218);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:536);__exit__ (synapse/util/metrics.py:127) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 1
check_auth_blocking (synapse/api/auth.py:691);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2481);addRawHeader (twisted/web/http_headers.py:242);setRawHeaders (twisted/web/http_headers.py:220) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:777);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:908);emit (sentry_sdk/integrations/logging.py:227);format (logging/__init__.py:880);format (logging/__init__.py:620) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:925);__exit__ (synapse/util/metrics.py:132);inc (prometheus_client/metrics.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 7
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);makeRecord (logging/__init__.py:1494);__init__ (logging/__init__.py:327) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);__exit__ (synapse/logging/context.py:544);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2101);headerReceived (twisted/web/http.py:2249) 2
current_sync_for_user (synapse/handlers/sync.py:346) 2
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:161) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:102);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);remove (synapse/util/async_helpers.py:105) 1
wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);gatherResults (twisted/internet/defer.py:1181);__init__ (twisted/internet/defer.py:1099) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);makeRecord (logging/__init__.py:1494);__init__ (logging/__init__.py:341) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2153);headerReceived (twisted/web/http.py:2260);setRawHeaders (twisted/web/http_headers.py:222);_encodeValues (twisted/web/http_headers.py:147) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1496);to_string (synapse/types.py:195) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 24
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 28
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:627);doWrite (twisted/internet/abstract.py:271);writeSomeData (twisted/internet/tcp.py:275);untilConcludes (twisted/python/util.py:815) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:152);sample_line (synapse/metrics/_exposition.py:79);<listcomp> (synapse/metrics/_exposition.py:79) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:261) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:199);observe (prometheus_client/metrics.py:535);inc (prometheus_client/values.py:20) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);time_it_out (synapse/util/async_helpers.py:461);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
on_RDATA (synapse/replication/tcp/handler.py:259);queue (synapse/util/async_helpers.py:250);_await_lock (synapse/util/async_helpers.py:289);make_deferred_yieldable (synapse/logging/context.py:696) 1
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1278);have_push_rules_changed_for_user (synapse/storage/data_stores/main/push_rule.py:139);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
on_RDATA (synapse/replication/tcp/handler.py:281) 1
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_do_execute (synapse/storage/database.py:243);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);new_transaction (synapse/storage/database.py:503);untilConcludes (twisted/python/util.py:815);_runCallbacks (twisted/internet/defer.py:711);on_GET (synapse/rest/client/v2_alpha/sync.py:186);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:915);<dictcomp> (synapse/handlers/sync.py:916) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798);requestDone (twisted/web/http.py:2395) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:536);__exit__ (synapse/util/metrics.py:121) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:222);_encodeValues (twisted/web/http_headers.py:147) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1959) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:629);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:260) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:195) 1
wait_for_events (synapse/notifier.py:353);new_listener (synapse/notifier.py:140);observe (synapse/util/async_helpers.py:107) 1
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:106);_process_event_stream_row (synapse/replication/slave/storage/events.py:136);invalidate_caches_for_event (synapse/replication/slave/storage/events.py:168);entity_has_changed (synapse/util/caches/stream_change_cache.py:147) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:579) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:138);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);check_auth_blocking (synapse/api/auth.py:702);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1604) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1512) 1
_get_appservice_user_id (synapse/api/auth.py:259);get_access_token_from_request (synapse/api/auth.py:612) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:97) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);helper (contextlib.py:239) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);filter_room_timeline (synapse/api/filtering.py:228);filter (synapse/api/filtering.py:373);check (synapse/api/filtering.py:316);check_fields (synapse/api/filtering.py:350) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);run_in_background (synapse/logging/context.py:674);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1481);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:350);new_listener (synapse/notifier.py:140);is_after (synapse/types.py:382) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:96) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);_have_rooms_changed (synapse/handlers/sync.py:1478);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:69) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1156) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:108) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);wrapped (synapse/util/caches/descriptors.py:616);getcallargs (inspect.py:1352) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:130);__init__ (synapse/logging/context.py:283) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2279) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);get (synapse/util/caches/response_cache.py:74) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:331);<listcomp> (synapse/storage/data_stores/main/stream.py:331);run_in_background (synapse/logging/context.py:640);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_room (synapse/storage/data_stores/main/stream.py:404);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291);deferToThreadPool (twisted/internet/threads.py:53);callInThreadWithCallback (twisted/python/threadpool.py:269);do (twisted/_threads/_team.py:166);do (twisted/_threads/_threadworker.py:106) 2
_generate_room_entry (synapse/handlers/sync.py:1791) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 8
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2485);writeSequence (twisted/internet/_newtls.py:204) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);make_deferred_yieldable (synapse/logging/context.py:710);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2158) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:648);loads (simplejson/__init__.py:525);decode (simplejson/decoder.py:374);raw_decode (simplejson/decoder.py:400) 1
check_auth_blocking (synapse/api/auth.py:733);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1030);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:131) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:97) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:552) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:704);on_new_event (synapse/notifier.py:307);__exit__ (synapse/util/metrics.py:127);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
iter_errors (jsonschema/validators.py:341) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);remove (synapse/util/caches/response_cache.py:105);call_later (synapse/util/__init__.py:99) 1
get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:333);make_deferred_yieldable (synapse/logging/context.py:710);ensureDeferred (twisted/internet/defer.py:917);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);ensureDeferred (twisted/internet/defer.py:911);run_in_background (synapse/logging/context.py:674);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477) 1
get_user_filter (synapse/api/filtering.py:145);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
ephemeral_by_room (synapse/handlers/sync.py:417);__exit__ (synapse/util/metrics.py:135);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:171);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 4
get_user_by_access_token (synapse/api/auth.py:313);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:311) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:931);check_schema (jsonschema/validators.py:294);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);anyOf (jsonschema/_validators.py:321) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1947) 1
get_user_filter (synapse/api/filtering.py:145);__init__ (synapse/api/filtering.py:191) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:971);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);__init__ (twisted/internet/defer.py:290) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_set_context_cb (synapse/logging/context.py:719);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_load_filtered_recents (synapse/handlers/sync.py:536);__exit__ (synapse/util/metrics.py:132);labels (prometheus_client/metrics.py:153) 1
on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:203);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);__lt__ (twisted/internet/base.py:181) 7
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:559);lineReceived (twisted/web/http.py:2108);__init__ (synapse/http/site.py:312);__init__ (synapse/http/site.py:72);__init__ (twisted/web/server.py:120);__init__ (twisted/web/http.py:764) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:619);doWrite (twisted/internet/abstract.py:257);writeSomeData (twisted/internet/tcp.py:275);untilConcludes (twisted/python/util.py:815) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:218) 124
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:135);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:648);prefill (synapse/util/caches/descriptors.py:225);inner (synapse/util/caches/lrucache.py:97);cache_set (synapse/util/caches/lrucache.py:190) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1038);flush (logging/__init__.py:1018) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:555);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2253) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:242);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2153);headerReceived (twisted/web/http.py:2260) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:298);get_resource_usage (synapse/logging/context.py:421) 1
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);wait (threading.py:310);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:908);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);__init__ (synapse/http/site.py:312);__init__ (synapse/http/site.py:62) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1177);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2195);__init__ (inspect.py:2472) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:405);get_new_events (synapse/handlers/typing.py:323);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403);__iadd__ (synapse/logging/context.py:156) 1
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103);inc_hits (synapse/util/caches/__init__.py:84) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:323);__enter__ (synapse/util/metrics.py:114) 1
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);_do_execute (synapse/storage/database.py:243);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);inContext (twisted/python/threadpool.py:261);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);inContext (twisted/python/threadpool.py:261);untilConcludes (twisted/python/util.py:815);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);do (twisted/_threads/_threadworker.py:114);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);inner_func (synapse/storage/database.py:580);get_thread_resource_usage (synapse/logging/context.py:55);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798);requestDone (twisted/web/http.py:2397);resumeProducing (twisted/internet/abstract.py:467);startReading (twisted/internet/abstract.py:435);addReader (twisted/internet/epollreactor.py:118);_add (twisted/internet/epollreactor.py:101) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1379);_have_rooms_changed (synapse/handlers/sync.py:1478);parse_stream_token (synapse/types.py:456) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1311);handle (logging/__init__.py:908);emit (logging/__init__.py:1132);emit (logging/__init__.py:1038);format (logging/__init__.py:880);format (logging/__init__.py:621);getMessage (logging/__init__.py:381) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2253) 1
collect (synapse/util/caches/__init__.py:113);_metrics_collection_callback (synapse/util/caches/descriptors.py:118);labels (prometheus_client/metrics.py:162) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);callback (synapse/util/async_helpers.py:71);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);_request_user_agent_is_curl (synapse/http/server.py:555) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);ensureDeferred (twisted/internet/defer.py:911);run_in_background (synapse/logging/context.py:674);set_current_context (synapse/logging/context.py:575);start (synapse/logging/context.py:205) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:155) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);_request_user_agent_is_curl (synapse/http/server.py:559);getRawHeaders (twisted/web/http_headers.py:266);_encodeName (twisted/web/http_headers.py:114) 1
encode_room (synapse/rest/client/v2_alpha/sync.py:421);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:189);make_deferred_yieldable (synapse/logging/context.py:704);isawaitable (inspect.py:226) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/util/caches/__init__.py:104);_metrics_collection_callback (synapse/util/caches/descriptors.py:118);labels (prometheus_client/metrics.py:153) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);remove (synapse/util/caches/response_cache.py:105);call_later (synapse/util/__init__.py:99);callLater (twisted/internet/base.py:795) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135);bisect_right (sortedcontainers/sortedlist.py:1215);_loc (sortedcontainers/sortedlist.py:594) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1030);_wrapped (synapse/util/caches/descriptors.py:438) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:184);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:97);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:72) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2248);setRawHeaders (twisted/web/http_headers.py:220) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);__init__ (synapse/http/site.py:312);__init__ (synapse/http/site.py:72);__init__ (twisted/web/server.py:120);__init__ (twisted/web/http.py:770);getHost (twisted/web/http.py:2527);getHost (twisted/internet/tcp.py:884) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1016);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:138);send (twisted/internet/defer.py:751) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);user_syncing (synapse/app/generic_worker.py:332) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:134) 2
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2101);headerReceived (twisted/web/http.py:2250) 1
_have_rooms_changed (synapse/handlers/sync.py:1480);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:78) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);count_listeners (synapse/notifier.py:197) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1152);_wrapped (synapse/util/caches/descriptors.py:459);get_instance (synapse/util/caches/descriptors.py:659);setdefault (weakref.py:288) 1
<genexpr> (jsonschema/_validators.py:272);is_type (jsonschema/validators.py:357);is_type (jsonschema/_types.py:95);is_object (jsonschema/_types.py:37) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);__enter__ (synapse/util/metrics.py:114);time (synapse/util/__init__.py:55) 1
get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);wrapped (synapse/util/caches/descriptors.py:567) 1
compute_state_delta (synapse/handlers/sync.py:934);__exit__ (synapse/util/metrics.py:135);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);time_it_out (synapse/util/async_helpers.py:461);cancel (twisted/internet/defer.py:548);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 2
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:114);<dictcomp> (synapse/metrics/background_process_metrics.py:114) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1682);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:8) 1
_get_appservice_user_id (synapse/api/auth.py:259);get_access_token_from_request (synapse/api/auth.py:612);getRawHeaders (twisted/web/http_headers.py:266) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:419) 12
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);__init__ (<attrs generated init synapse.handlers.sync.DeviceLists>:4) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);headerReceived (twisted/web/http.py:2233);setRawHeaders (twisted/web/http_headers.py:222);<listcomp> (twisted/web/http_headers.py:220);_sanitizeLinearWhitespace (twisted/web/http_headers.py:40) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:476) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1845);filter_room_account_data (synapse/api/filtering.py:234);filter (synapse/api/filtering.py:373) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:132) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:779);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:241);labels (prometheus_client/metrics.py:162) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);get_entities_changed (synapse/util/caches/stream_change_cache.py:97) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);__enter__ (synapse/logging/context.py:531);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);start (twisted/web/static.py:765);registerProducer (twisted/web/http.py:987);registerProducer (twisted/web/http.py:2578) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);set (synapse/util/caches/response_cache.py:108);observe (synapse/util/async_helpers.py:107) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);_started_processing (synapse/http/site.py:236) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:458);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:251) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v1/events.py:64);get_stream (synapse/handlers/events.py:98);get_events_for (synapse/notifier.py:403);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_room_ids (synapse/notifier.py:484);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_is_world_readable (synapse/notifier.py:492);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state (synapse/state/__init__.py:135);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
<genexpr> (jsonschema/_validators.py:272);is_type (jsonschema/validators.py:357);is_type (jsonschema/_types.py:95);__getitem__ (pyrsistent/_pmap.py:71);_getitem (pyrsistent/_pmap.py:66) 1
_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:352);new_listener (synapse/notifier.py:140);observe (synapse/util/async_helpers.py:107) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);stop (synapse/logging/context.py:403);set_current_context (synapse/logging/context.py:577);__exit__ (synapse/logging/context.py:319);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:307);__exit__ (synapse/util/metrics.py:124);__exit__ (synapse/logging/context.py:307);set_current_context (synapse/logging/context.py:573);stop (synapse/logging/context.py:377) 1
_generate_sync_entry_for_to_device (synapse/handlers/sync.py:1225);copy_and_replace (synapse/types.py:409);_replace (collections/__init__.py:414) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:161);inc (prometheus_client/metrics.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);__exit__ (synapse/logging/context.py:544) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1646);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:8) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);inContext (twisted/python/threadpool.py:261);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);new_transaction (synapse/storage/database.py:503);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);set_cors_headers (synapse/http/server.py:531);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:222);_encodeValues (twisted/web/http_headers.py:147);_encodeValue (twisted/web/http_headers.py:129) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1646) 1
runWithConnection (synapse/storage/database.py:583);make_deferred_yieldable (synapse/logging/context.py:710);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:298);get_method (synapse/http/site.py:107) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:323);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403);__iadd__ (synapse/logging/context.py:156) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 14
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:261) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:81);<genexpr> (synapse/visibility.py:81);event_id (synapse/events/__init__.py:468);compute_event_reference_hash (synapse/crypto/event_signing.py:115);prune_event (synapse/events/utils.py:58);make_event_from_dict (synapse/events/__init__.py:503);__init__ (synapse/events/__init__.py:395);<dictcomp> (synapse/events/__init__.py:386) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1034);format (logging/__init__.py:880);format (logging/__init__.py:622);formatMessage (logging/__init__.py:591);format (logging/__init__.py:433) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);f (synapse/storage/data_stores/main/receipts.py:228);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:995);get_rooms_for_user_at (synapse/handlers/sync.py:1946) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);__enter__ (contextlib.py:112) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1029) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);__init__ (twisted/python/failure.py:398);qual (twisted/python/reflect.py:367) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);process_and_notify (synapse/app/generic_worker.py:742);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);ensureDeferred (twisted/internet/defer.py:911);run_in_background (synapse/logging/context.py:674);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);parse_command_from_line (synapse/replication/tcp/commands.py:492);from_line (synapse/replication/tcp/commands.py:134);loads (simplejson/__init__.py:525);decode (simplejson/decoder.py:374);raw_decode (simplejson/decoder.py:400) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:157);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:932);best_match (jsonschema/exceptions.py:367);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);resolve (jsonschema/validators.py:766);resolve_from_url (jsonschema/validators.py:781);resolve_fragment (jsonschema/validators.py:802) 1
get_rooms_for_user_at (synapse/handlers/sync.py:1959);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:701);isawaitable (inspect.py:226) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:951);_wrapped (synapse/util/caches/descriptors.py:438);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159);move_node_to_front (synapse/util/caches/lrucache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);get_entities_changed (synapse/util/caches/stream_change_cache.py:97);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:147) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);set_cors_headers (synapse/http/server.py:531);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:222);<listcomp> (twisted/web/http_headers.py:220);_sanitizeLinearWhitespace (twisted/web/http_headers.py:40) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1653);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:6) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);__exit__ (synapse/logging/context.py:544);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
handle_command (synapse/replication/tcp/protocol.py:267);on_RDATA (synapse/replication/tcp/handler.py:268);queue (synapse/util/async_helpers.py:273);contextmanager (contextlib.py:240);update_wrapper (functools.py:65) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 2
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);inContext (twisted/python/threadpool.py:261);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);new_transaction (synapse/storage/database.py:503);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:573);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:971);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1511);__init__ (<attrs generated init twisted.internet.defer._CancellationStatus>:1) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allHeadersReceived (twisted/web/http.py:2320) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798) 1
get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);filter_state (synapse/storage/state.py:256) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 5
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:476);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:296);iterencode (simplejson/encoder.py:378) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_user_by_req (synapse/api/auth.py:205);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
get_rooms_for_user_at (synapse/handlers/sync.py:1959);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:910) 1
on_RDATA (synapse/replication/tcp/handler.py:281);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:908);emit (sentry_sdk/integrations/logging.py:227);format (logging/__init__.py:880);format (logging/__init__.py:636);usesTime (logging/__init__.py:588);usesTime (logging/__init__.py:430) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:311) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:505);new_transaction (synapse/storage/database.py:419) 7
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:148);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:473) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);headerReceived (twisted/web/http.py:2260);setRawHeaders (twisted/web/http_headers.py:222);_encodeValues (twisted/web/http_headers.py:147);_encodeValue (twisted/web/http_headers.py:129) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305) 1
filter_events_for_client (synapse/visibility.py:96);wrapped (synapse/util/caches/descriptors.py:620);make_deferred_yieldable (synapse/logging/context.py:708);ensureDeferred (twisted/internet/defer.py:910) 1
ephemeral_by_room (synapse/handlers/sync.py:417);__exit__ (synapse/util/metrics.py:135);labels (prometheus_client/metrics.py:149) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 10
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);unregisterProducer (twisted/web/http.py:994);unregisterProducer (twisted/web/http.py:2597);stopStreaming (twisted/internet/_producer_helpers.py:103);stop (twisted/internet/task.py:498);__init__ (twisted/python/failure.py:398);qual (twisted/python/reflect.py:367) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_load_filtered_recents (synapse/handlers/sync.py:536);__exit__ (synapse/util/metrics.py:131);labels (prometheus_client/metrics.py:152) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:148) 1
unread_notifs_for_room_id (synapse/handlers/sync.py:953);__exit__ (synapse/util/metrics.py:131);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2245);_maybeChooseTransferDecoder (twisted/web/http.py:2210) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:102) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);__enter__ (synapse/logging/context.py:292) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:648) 1
get_user_filter (synapse/api/filtering.py:145);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:910) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:929);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_events (synapse/storage/data_stores/main/events_worker.py:229);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);write (twisted/web/server.py:275);write (twisted/web/http.py:1176);write (twisted/web/http.py:2497);write (twisted/internet/_newtls.py:191);write (twisted/internet/abstract.py:356);startWriting (twisted/internet/abstract.py:443);addWriter (twisted/internet/epollreactor.py:135);_add (twisted/internet/epollreactor.py:94) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);run_in_background (synapse/logging/context.py:674);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901) 11
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:454);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:657);on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:106);_process_event_stream_row (synapse/replication/slave/storage/events.py:136);invalidate_caches_for_event (synapse/replication/slave/storage/events.py:174);entity_has_changed (synapse/util/caches/stream_change_cache.py:156);__delitem__ (sortedcontainers/sorteddict.py:260);remove (sortedcontainers/sortedlist.py:453) 1
_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);start (twisted/web/static.py:765);registerProducer (twisted/web/http.py:987);registerProducer (twisted/web/http.py:2581);startStreaming (twisted/internet/_producer_helpers.py:90);cooperate (twisted/internet/task.py:753);cooperate (twisted/internet/task.py:624);__init__ (twisted/internet/task.py:415);_addTask (twisted/internet/task.py:637);_reschedule (twisted/internet/task.py:681) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);_started_processing (synapse/http/site.py:239);get_redacted_uri (synapse/http/site.py:92);redact_uri (synapse/http/__init__.py:51) 1
encode_room (synapse/rest/client/v2_alpha/sync.py:421);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:189);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917);_handle_fromlist (<frozen importlib._bootstrap>:1028) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);f (synapse/metrics/__init__.py:473);runUntilCurrent (twisted/internet/base.py:935);_tick (twisted/internet/task.py:672);_oneWorkUnit (twisted/internet/task.py:528);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798);requestDone (twisted/web/http.py:2397);setTimeout (twisted/protocols/policies.py:737) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);inlineCallbacks (twisted/internet/defer.py:1614) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:435) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:630) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1485);filter_events_for_client (synapse/visibility.py:96);wrapped (synapse/util/caches/descriptors.py:551) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:514) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_have_rooms_changed (synapse/handlers/sync.py:1480);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:78);inc_hits (synapse/util/caches/__init__.py:84) 1
on_RDATA (synapse/replication/tcp/handler.py:281);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);makeRecord (logging/__init__.py:1494);__init__ (logging/__init__.py:363) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1033);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460) 1
measured_func (synapse/util/metrics.py:74);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403);_get_cputime (synapse/logging/context.py:457) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1422);check_auth_blocking (synapse/api/auth.py:702);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);__enter__ (synapse/logging/context.py:531) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:311) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);to_string (synapse/types.py:195) 1
_generate_room_entry (synapse/handlers/sync.py:1916);unread_notifs_for_room_id (synapse/handlers/sync.py:953);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159);get (synapse/util/caches/treecache.py:38) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:925);inner (synapse/util/caches/lrucache.py:97) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);getContext (twisted/python/context.py:125);getContext (twisted/python/context.py:103) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);on_GET (synapse/rest/client/v2_alpha/sync.py:186);new_transaction (synapse/storage/database.py:503);_do_execute (synapse/storage/database.py:243);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421);_concurrently_execute_inner (synapse/util/async_helpers.py:159) 1
_get_events_from_cache_or_db (synapse/storage/data_stores/main/events_worker.py:426);_get_events_from_cache (synapse/storage/data_stores/main/events_worker.py:458);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159);move_node_to_front (synapse/util/caches/lrucache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1386);_have_rooms_changed (synapse/handlers/sync.py:1478);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:85) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:779);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2485);writeSequence (twisted/internet/_newtls.py:204);writeSequence (twisted/internet/abstract.py:384);startWriting (twisted/internet/abstract.py:443);addWriter (twisted/internet/epollreactor.py:127);_add (twisted/internet/epollreactor.py:94) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:548);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:999) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 16
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1786) 1
<genexpr> (jsonschema/_validators.py:272) 2
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);get_current_token (synapse/streams/events.py:51) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:231);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:627);doWrite (twisted/internet/abstract.py:257);_concatenate (twisted/internet/abstract.py:24) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_generate_room_entry (synapse/handlers/sync.py:1895);unread_notifs_for_room_id (synapse/handlers/sync.py:953);__exit__ (synapse/util/metrics.py:129) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:435) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:761);__getitem__ (frozendict/__init__.py:29) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:218);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:304);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:694);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:241) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1945) 1
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1278) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:298);get_resource_usage (synapse/logging/context.py:425);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);__init__ (twisted/python/failure.py:396) 2
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1177);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2161) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:122) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:629);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 5
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_user_by_req (synapse/api/auth.py:205);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);run (synapse/metrics/background_process_metrics.py:220);update_metrics (synapse/metrics/background_process_metrics.py:157);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 10
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:905);emit (sentry_sdk/integrations/logging.py:227);format (logging/__init__.py:880);format (logging/__init__.py:622);getMessage (logging/__init__.py:380) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);get (synapse/util/caches/response_cache.py:73) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_users_whose_devices_changed_txn (synapse/storage/data_stores/main/devices.py:564);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 3
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:779);stopProducing (twisted/web/static.py:755) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);get (synapse/util/caches/response_cache.py:74);inc_misses (synapse/util/caches/__init__.py:87) 1
on_RDATA (synapse/replication/tcp/handler.py:281);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:310);__enter__ (synapse/util/metrics.py:111) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:645) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:331);<listcomp> (synapse/storage/data_stores/main/stream.py:331);run_in_background (synapse/logging/context.py:640);unwindGenerator (twisted/internet/defer.py:1613) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:311);_runCallbacks (twisted/internet/defer.py:669) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:230);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_users_who_share_room_with_user (synapse/storage/data_stores/main/roommember.py:500) 5
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:505);new_transaction (synapse/storage/database.py:418);_fetch_event_rows (synapse/storage/data_stores/main/events_worker.py:746);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 25
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:409);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:189);gatherResults (twisted/internet/defer.py:1182) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 3
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:946);_wrapped (synapse/util/caches/descriptors.py:438) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);maybe_awaitable (synapse/util/async_helpers.py:516) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:220);update_metrics (synapse/metrics/background_process_metrics.py:156) 1
ref (jsonschema/_validators.py:266) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);ephemeral_by_room (synapse/handlers/sync.py:417);__exit__ (synapse/util/metrics.py:135);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 7
generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);gatherResults (twisted/internet/defer.py:1181);__init__ (twisted/internet/defer.py:1099);addCallbacks (twisted/internet/defer.py:311) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:236);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:97) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1959) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:84) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1646);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:8) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:182) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:657);on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:106);_process_event_stream_row (synapse/replication/slave/storage/events.py:136);invalidate_caches_for_event (synapse/replication/slave/storage/events.py:168);entity_has_changed (synapse/util/caches/stream_change_cache.py:160);__setitem__ (sortedcontainers/sorteddict.py:307) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:236);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:136);islice (sortedcontainers/sortedlist.py:993);_pos (sortedcontainers/sortedlist.py:684) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:5) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:657);on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:106);_process_event_stream_row (synapse/replication/slave/storage/events.py:136);invalidate_caches_for_event (synapse/replication/slave/storage/events.py:168);<lambda> (synapse/util/caches/descriptors.py:464);invalidate (synapse/util/caches/descriptors.py:229) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:981);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_token (synapse/streams/events.py:47) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);succeed (twisted/internet/defer.py:89) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:229) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:300);iterencode (simplejson/encoder.py:380) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);__init__ (jsonschema/validators.py:289);from_schema (jsonschema/validators.py:682);__init__ (jsonschema/validators.py:660) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);_started_processing (synapse/http/site.py:239);start (synapse/http/request_metrics.py:160) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);_have_rooms_changed (synapse/handlers/sync.py:1478);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:71) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);get (synapse/util/caches/descriptors.py:160);_wrapped (synapse/util/caches/descriptors.py:459);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1156);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:545);get_entities_changed (synapse/util/caches/stream_change_cache.py:97) 1
new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);generate_sync_result (synapse/handlers/sync.py:1053);current_sync_for_user (synapse/handlers/sync.py:346);wait_for_events (synapse/notifier.py:375);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1037);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:129);get_resource_usage (synapse/logging/context.py:425);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1030);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:128);get_resource_usage (synapse/logging/context.py:425);copy (synapse/logging/context.py:119) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:627);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:476) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1477);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:263);_insert_into_cache (synapse/storage/data_stores/state/store.py:350) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 8
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);properties (jsonschema/_validators.py:288);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);ref (jsonschema/_validators.py:266);iter_errors (jsonschema/validators.py:341);iter_errors (jsonschema/validators.py:341);ref (jsonschema/_validators.py:263);descend (jsonschema/validators.py:344) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);new_transaction (synapse/storage/database.py:503);new_transaction (synapse/storage/database.py:503);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691);_wrapped (synapse/util/caches/descriptors.py:443);get (synapse/util/caches/descriptors.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1269) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 2
on_RDATA (synapse/replication/tcp/handler.py:281);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);makeRecord (logging/__init__.py:1494);__init__ (logging/__init__.py:363);splitext (posixpath.py:129);_splitext (genericpath.py:135) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);run_in_background (synapse/logging/context.py:674);g (synapse/logging/context.py:616);maybeDeferred (twisted/internet/defer.py:156);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 17
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305) 2
_look_up_user_by_access_token (synapse/api/auth.py:483);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917);iscoroutine (asyncio/coroutines.py:178) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:148);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);isawaitable (inspect.py:226);__instancecheck__ (abc.py:139) 1
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:648);make_event_from_dict (synapse/events/__init__.py:503);__init__ (synapse/events/__init__.py:410);intern_dict (synapse/util/caches/__init__.py:164);<dictcomp> (synapse/util/caches/__init__.py:164);_intern_known_values (synapse/util/caches/__init__.py:172);intern_string (synapse/util/caches/__init__.py:154) 1
dependencies (jsonschema/_validators.py:240);is_type (jsonschema/validators.py:357);is_type (jsonschema/_types.py:91);__getitem__ (pyrsistent/_pmap.py:71);_getitem (pyrsistent/_pmap.py:66);_get_bucket (pyrsistent/_pmap.py:58) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:217);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_notify_app_services (synapse/notifier.py:279) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);__init__ (synapse/http/site.py:312);__init__ (synapse/http/site.py:72);__init__ (twisted/web/server.py:120);__init__ (twisted/python/components.py:192) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);delete_messages_for_device_txn (synapse/storage/data_stores/main/deviceinbox.py:110);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);handle (logging/__init__.py:908);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1469);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);get_user_by_req (synapse/api/auth.py:188);get_access_token_from_request (synapse/api/auth.py:612) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1156);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:545);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1665) 1
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1278);have_push_rules_changed_for_user (synapse/storage/data_stores/main/push_rule.py:139);has_entity_changed (synapse/util/caches/stream_change_cache.py:84) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421) 1
get_user_filter (synapse/api/filtering.py:145);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:657);on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121);process_replication_rows (synapse/replication/slave/storage/room.py:42);process_replication_rows (synapse/replication/slave/storage/presence.py:60);process_replication_rows (synapse/replication/slave/storage/_base.py:84);_invalidate_state_caches (synapse/storage/_base.py:63);_attempt_to_invalidate_cache (synapse/storage/_base.py:84);<lambda> (synapse/util/caches/descriptors.py:464);invalidate (synapse/util/caches/descriptors.py:229);inner (synapse/util/caches/lrucache.py:97);cache_pop (synapse/util/caches/lrucache.py:206);delete_node (synapse/util/caches/lrucache.py:149) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_users_who_share_room_with_user (synapse/storage/data_stores/main/roommember.py:498);_wrapped (synapse/util/caches/descriptors.py:438);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917) 1
handle_command (synapse/replication/tcp/protocol.py:267);on_RDATA (synapse/replication/tcp/handler.py:268);queue (synapse/util/async_helpers.py:273);addCallback (twisted/internet/defer.py:322);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:711);helper (contextlib.py:239);__init__ (contextlib.py:88) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_handle_fromlist (<frozen importlib._bootstrap>:1044) 2
descend (jsonschema/validators.py:349) 1
run (synapse/metrics/background_process_metrics.py:220);__exit__ (synapse/logging/context.py:319) 1
_look_up_user_by_access_token (synapse/api/auth.py:483);from_string (synapse/types.py:178) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:139);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 3
_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:151);run_in_background (synapse/logging/context.py:674);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:350);new_listener (synapse/notifier.py:140);is_after (synapse/types.py:389);room_stream_id (synapse/types.py:376) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:888) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1152);getRawHeaders (twisted/web/http_headers.py:266);_encodeName (twisted/web/http_headers.py:114) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:995);get_rooms_for_user_at (synapse/handlers/sync.py:1945) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135);bisect_right (sortedcontainers/sortedlist.py:1214) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 61
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_fetch (synapse/storage/data_stores/main/events_worker.py:479);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);untilConcludes (twisted/python/util.py:815);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421);measured_func (synapse/util/metrics.py:82);__exit__ (synapse/util/metrics.py:129);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:629);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1011);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1379);_have_rooms_changed (synapse/handlers/sync.py:1478) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1467);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:929);__exit__ (synapse/util/metrics.py:132);labels (prometheus_client/metrics.py:162) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);set_cors_headers (synapse/http/server.py:531);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:218) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460) 1
_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:151);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:320) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:84);callHandlers (logging/__init__.py:1591) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:323);succeed (twisted/internet/defer.py:90);__init__ (twisted/internet/defer.py:290) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:999);_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1252) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:323) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);queue (synapse/util/async_helpers.py:273);addCallback (twisted/internet/defer.py:322) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);_have_rooms_changed (synapse/handlers/sync.py:1478) 1
current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1053) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2153);headerReceived (twisted/web/http.py:2253);getRawHeaders (twisted/web/http_headers.py:266) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1346) 1
_get_events_from_cache_or_db (synapse/storage/data_stores/main/events_worker.py:426);_get_events_from_cache (synapse/storage/data_stores/main/events_worker.py:458);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:157) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:761);__getitem__ (frozendict/__init__.py:29) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1040);format (logging/__init__.py:880);format (logging/__init__.py:636);formatMessage (logging/__init__.py:591);format (logging/__init__.py:433) 1
ephemeral_by_room (synapse/handlers/sync.py:417);__exit__ (synapse/util/metrics.py:133);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:573) 1
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1278);have_push_rules_changed_for_user (synapse/storage/data_stores/main/push_rule.py:139) 1
_generate_sync_entry_for_to_device (synapse/handlers/sync.py:1225);_trace_inner (synapse/logging/opentracing.py:706);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);delete_messages_for_device (synapse/storage/data_stores/main/deviceinbox.py:90) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:134) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2147);headerReceived (twisted/web/http.py:2253) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:223) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:761);__getitem__ (frozendict/__init__.py:29) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:449);blocks_all_room_timeline (synapse/api/filtering.py:253);filters_all_rooms (synapse/api/filtering.py:282) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278) 1
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:458);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:708);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:109);__enter__ (synapse/logging/context.py:528);set_current_context (synapse/logging/context.py:573);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1891) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:2) 3
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_set_context_cb (synapse/logging/context.py:719);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:556);lineReceived (twisted/web/http.py:2103);headerReceived (twisted/web/http.py:2249);getRawHeaders (twisted/web/http_headers.py:266) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);_get_handler_for_request (synapse/http/server.py:361) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1033);measured_func (synapse/util/metrics.py:73);__enter__ (synapse/util/metrics.py:114);__init__ (synapse/logging/context.py:283) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2481);addRawHeader (twisted/web/http_headers.py:242);getRawHeaders (twisted/web/http_headers.py:266) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:152);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:312) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:401);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:186);gatherResults (twisted/internet/defer.py:1183);__init__ (twisted/internet/defer.py:1100);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
wait_for_events (synapse/notifier.py:353);__enter__ (synapse/logging/context.py:531) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121);process_replication_rows (synapse/replication/slave/storage/room.py:42);process_replication_rows (synapse/replication/slave/storage/presence.py:60);process_replication_rows (synapse/replication/slave/storage/_base.py:84);_invalidate_state_caches (synapse/storage/_base.py:63);_attempt_to_invalidate_cache (synapse/storage/_base.py:84);<lambda> (synapse/util/caches/descriptors.py:464);invalidate (synapse/util/caches/descriptors.py:229);inner (synapse/util/caches/lrucache.py:97);cache_pop (synapse/util/caches/lrucache.py:206);delete_node (synapse/util/caches/lrucache.py:149);invalidate (synapse/util/caches/descriptors.py:646);invalidate (synapse/util/caches/descriptors.py:229) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_state_groups_from_groups_txn (synapse/storage/data_stores/state/bg_updates.py:128) 1
get_events_as_list (synapse/storage/data_stores/main/events_worker.py:274);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_cache_or_db (synapse/storage/data_stores/main/events_worker.py:421);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);filter_room_timeline (synapse/api/filtering.py:228);filter (synapse/api/filtering.py:373);check (synapse/api/filtering.py:319);check_fields (synapse/api/filtering.py:337) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:761) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:139);parse_string (synapse/http/servlet.py:147) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:135);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291);deferToThreadPool (twisted/internet/threads.py:53);callInThreadWithCallback (twisted/python/threadpool.py:269) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:892) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doWrite (twisted/internet/abstract.py:257);writeSomeData (twisted/internet/tcp.py:275);untilConcludes (twisted/python/util.py:815) 1
wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:336) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:454);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);__init__ (<attrs generated init twisted.internet.defer._CancellationStatus>:3) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 7
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1668) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/posixbase.py:145);readFromFD (twisted/internet/fdesc.py:86) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:268);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1038);format (logging/__init__.py:880);format (logging/__init__.py:636);formatMessage (logging/__init__.py:591);format (logging/__init__.py:433) 1
on_RDATA (synapse/replication/tcp/handler.py:259);queue (synapse/util/async_helpers.py:273);contextmanager (contextlib.py:240);update_wrapper (functools.py:65) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);_started_processing (synapse/http/site.py:239);get_redacted_uri (synapse/http/site.py:92) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:456);filter_room_timeline (synapse/api/filtering.py:228) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:627) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);__init__ (<attrs generated init twisted.internet.defer._CancellationStatus>:3) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_paginate_room_events_txn (synapse/storage/data_stores/main/stream.py:909);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:447);maybeDeferred (twisted/internet/defer.py:151);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:640);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_users_who_share_room_with_user (synapse/storage/data_stores/main/roommember.py:498);_wrapped (synapse/util/caches/descriptors.py:443);make_deferred_yieldable (synapse/logging/context.py:696);ensureDeferred (twisted/internet/defer.py:910) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:449) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (prometheus_client/metrics.py:73);add_sample (prometheus_client/metrics_core.py:42) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:152);sample_line (synapse/metrics/_exposition.py:90);floatToGoString (synapse/metrics/_exposition.py:67) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1377);getfullargspec (inspect.py:1177);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2154);isfunction (inspect.py:169) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:779);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:238) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:130) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);filter_room_ephemeral (synapse/api/filtering.py:231);filter (synapse/api/filtering.py:373);check (synapse/api/filtering.py:319);check_fields (synapse/api/filtering.py:350) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:394);__init__ (synapse/state/__init__.py:77);__init__ (frozendict/__init__.py:25) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:459);get_instance (synapse/util/caches/descriptors.py:659);setdefault (weakref.py:279) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);labels (prometheus_client/metrics.py:162) 2
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1248);send (twisted/internet/defer.py:743) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:971);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_token (synapse/streams/events.py:45) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:432);__enter__ (synapse/util/metrics.py:111) 1
get_state_for_events (synapse/storage/state.py:454);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_events (synapse/storage/data_stores/main/events_worker.py:229);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_events_as_list (synapse/storage/data_stores/main/events_worker.py:274) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:195);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:171);to_string (synapse/types.py:195) 1
get_users_whose_signatures_changed (synapse/storage/data_stores/main/devices.py:593) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235) 1
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:907) 1
_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:551);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1477) 1
get_state_ids_for_events (synapse/storage/state.py:494);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1419) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:458);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 3
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);_request_user_agent_is_curl (synapse/http/server.py:559);getRawHeaders (twisted/web/http_headers.py:262) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:162);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:467) 194
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:165);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 3
type (jsonschema/_validators.py:273);<genexpr> (jsonschema/_validators.py:272);is_type (jsonschema/validators.py:357);is_type (jsonschema/_types.py:95);__getitem__ (pyrsistent/_pmap.py:71);_getitem (pyrsistent/_pmap.py:66);_get_bucket (pyrsistent/_pmap.py:58) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:139) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);resolve (jsonschema/validators.py:766);resolve_from_url (jsonschema/validators.py:781);__getitem__ (jsonschema/_utils.py:22);normalize (jsonschema/_utils.py:15) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v1/events.py:64);get_stream (synapse/handlers/events.py:98);get_events_for (synapse/notifier.py:403);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_room_ids (synapse/notifier.py:484);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_is_world_readable (synapse/notifier.py:492);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state (synapse/state/__init__.py:135);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 1
generate_sync_result (synapse/handlers/sync.py:1053) 1
untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/receipts.py:241);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/receipts.py:241);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);concurrently_execute (synapse/util/async_helpers.py:168);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:655);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:875);_calculate_state (synapse/handlers/sync.py:1998);<dictcomp> (synapse/handlers/sync.py:1994) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:130);__init__ (synapse/logging/context.py:283) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);__init__ (synapse/http/site.py:312);__init__ (synapse/http/site.py:72);__init__ (twisted/web/server.py:120);__init__ (twisted/web/http.py:770);getPeer (twisted/web/http.py:2518);getPeer (twisted/internet/tcp.py:894) 1
on_RDATA (synapse/replication/tcp/handler.py:259);queue (synapse/util/async_helpers.py:273);contextmanager (contextlib.py:240);update_wrapper (functools.py:60) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);__enter__ (synapse/util/metrics.py:113);__init__ (synapse/logging/context.py:260) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 2
unread_notifs_for_room_id (synapse/handlers/sync.py:953);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:401) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);run_in_background (synapse/logging/context.py:674);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);__init__ (twisted/internet/defer.py:290) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);_have_rooms_changed (synapse/handlers/sync.py:1478);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:78) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 3
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:135);inc (prometheus_client/metrics.py:244) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613) 1
current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1045) 1
compute_state_delta (synapse/handlers/sync.py:934);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 4
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);count_listeners (synapse/notifier.py:201);<genexpr> (synapse/notifier.py:201);count_listeners (synapse/notifier.py:125);observers (synapse/util/async_helpers.py:116) 2
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:951);_wrapped (synapse/util/caches/descriptors.py:447);get (synapse/util/caches/descriptors.py:160) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 3
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121);process_replication_rows (synapse/replication/slave/storage/room.py:42);process_replication_rows (synapse/replication/slave/storage/presence.py:59) 1
measured_func (synapse/util/metrics.py:74) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1033);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_groups (synapse/handlers/sync.py:1066) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_user_by_req (synapse/api/auth.py:232);insert_client_ip (synapse/replication/slave/storage/client_ips.py:48) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:158);labels (prometheus_client/metrics.py:152) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295) 1
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 1
process_and_notify (synapse/app/generic_worker.py:742);on_new_room_event (synapse/notifier.py:240);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:307);__exit__ (synapse/util/metrics.py:131);labels (prometheus_client/metrics.py:153) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:157) 1
getAllRawHeaders (twisted/web/http_headers.py:276);_canonicalNameCaps (twisted/web/http_headers.py:279) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1152) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1789) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);check_auth_blocking (synapse/api/auth.py:702);__getattr__ (synapse/config/_base.py:224) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1016);_generate_sync_entry_for_to_device (synapse/handlers/sync.py:1209) 1
_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1383);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1510);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doWrite (twisted/internet/abstract.py:271) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:505);new_transaction (synapse/storage/database.py:418);_fetch_event_rows (synapse/storage/data_stores/main/events_worker.py:746);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236);decode (encodings/utf_8.py:16) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:652);__new__ (<string>:1) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:447);maybeDeferred (twisted/internet/defer.py:151);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:640);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_users_who_share_room_with_user (synapse/storage/data_stores/main/roommember.py:500);_wrapped (synapse/util/caches/descriptors.py:443);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:459);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2260);setRawHeaders (twisted/web/http_headers.py:218);_encodeValues (twisted/web/http_headers.py:147) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:157);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);headerReceived (twisted/web/http.py:2249);setRawHeaders (twisted/web/http_headers.py:222) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);wrapped_callback (synapse/util/__init__.py:96) 2
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:132);labels (prometheus_client/metrics.py:149) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:271);filter_state (synapse/storage/state.py:251) 1
unread_notifs_for_room_id (synapse/handlers/sync.py:951);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:708);isawaitable (inspect.py:226) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:528);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2481);addRawHeader (twisted/web/http_headers.py:242);setRawHeaders (twisted/web/http_headers.py:222) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);shouldFlush (logging/handlers.py:1290) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:81);<genexpr> (synapse/visibility.py:81);event_id (synapse/events/__init__.py:468);compute_event_reference_hash (synapse/crypto/event_signing.py:115);prune_event (synapse/events/utils.py:58);make_event_from_dict (synapse/events/__init__.py:503);__init__ (synapse/events/__init__.py:410);intern_dict (synapse/util/caches/__init__.py:164);<dictcomp> (synapse/util/caches/__init__.py:164);_intern_known_values (synapse/util/caches/__init__.py:172) 1
runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:311);_runCallbacks (twisted/internet/defer.py:691) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:708);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:971);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_token (synapse/streams/events.py:45) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:109);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:315);get_entities_changed (synapse/util/caches/stream_change_cache.py:97) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1418) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:261);loads (simplejson/__init__.py:525);decode (simplejson/decoder.py:368);raw_decode (simplejson/decoder.py:400) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:445);wrapped (synapse/util/caches/descriptors.py:534);getcallargs (inspect.py:1334);getfullargspec (inspect.py:1137);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2154) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:236) 21
_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:559) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);ephemeral_by_room (synapse/handlers/sync.py:415);copy_and_replace (synapse/types.py:409);_replace (collections/__init__.py:417);_make (collections/__init__.py:408) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:231);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:222) 1
serialize_event (synapse/events/utils.py:402) 1
_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:152) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:628) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:971);unwindGenerator (twisted/internet/defer.py:1613) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1947) 2
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);count_listeners (synapse/notifier.py:201);<genexpr> (synapse/notifier.py:201) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:329);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);time_msec (synapse/util/__init__.py:59);time (synapse/util/__init__.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);filter_events_for_client (synapse/visibility.py:257);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);isawaitable (inspect.py:226);__instancecheck__ (abc.py:139) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:694) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:8) 9
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:176);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421);get_user_filter (synapse/api/filtering.py:145);__init__ (synapse/api/filtering.py:183) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doWrite (twisted/internet/abstract.py:290);stopWriting (twisted/internet/abstract.py:430);removeWriter (twisted/internet/epollreactor.py:183);_remove (twisted/internet/epollreactor.py:156) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);get_redacted_uri (synapse/http/site.py:92);redact_uri (synapse/http/__init__.py:50) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1371) 1
_generate_room_entry (synapse/handlers/sync.py:1758) 4
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:514) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291);deferToThreadPool (twisted/internet/threads.py:53);__init__ (twisted/internet/defer.py:290) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:946);__enter__ (synapse/util/metrics.py:114);__init__ (synapse/logging/context.py:278) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2101);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:304);ensureDeferred (twisted/internet/defer.py:917);_handle_fromlist (<frozen importlib._bootstrap>:1020) 1
compute_state_delta (synapse/handlers/sync.py:934);__exit__ (synapse/util/metrics.py:135);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:148);inc (prometheus_client/metrics.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2238);getRawHeaders (twisted/web/http_headers.py:266) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);__init__ (twisted/python/failure.py:314) 1
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:106);_process_event_stream_row (synapse/replication/slave/storage/events.py:136);invalidate_caches_for_event (synapse/replication/slave/storage/events.py:165);invalidate_many (synapse/util/caches/descriptors.py:246);inner (synapse/util/caches/lrucache.py:97);cache_del_multi (synapse/util/caches/lrucache.py:217);pop (synapse/util/caches/treecache.py:53) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:953);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
on_RDATA (synapse/replication/tcp/handler.py:281);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:905);emit (sentry_sdk/integrations/logging.py:226) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291);deferToThreadPool (twisted/internet/threads.py:53);callInThreadWithCallback (twisted/python/threadpool.py:269);do (twisted/_threads/_team.py:166);do (twisted/_threads/_threadworker.py:109);<lambda> (twisted/_threads/_team.py:166);_coordinateThisTask (twisted/_threads/_team.py:187);do (twisted/_threads/_threadworker.py:57);put (queue.py:132);__enter__ (threading.py:240) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:634);_wrapped (synapse/util/caches/descriptors.py:443) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);unregisterProducer (twisted/web/http.py:994);unregisterProducer (twisted/web/http.py:2597);stopStreaming (twisted/internet/_producer_helpers.py:103);stop (twisted/internet/task.py:498);_completeWith (twisted/internet/task.py:487);_removeTask (twisted/internet/task.py:648) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2125);__init__ (synapse/http/site.py:312) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:721);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1609) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:96);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:415);__exit__ (synapse/util/metrics.py:127) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);_generate_sync_entry_for_to_device (synapse/handlers/sync.py:1210) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);run_in_background (synapse/logging/context.py:674) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:648);make_event_from_dict (synapse/events/__init__.py:503);__init__ (synapse/events/__init__.py:410);__init__ (synapse/events/__init__.py:228);__init__ (synapse/events/__init__.py:107) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:619);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);check_auth_blocking (synapse/api/auth.py:702);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
handle_command (synapse/replication/tcp/protocol.py:267);on_RDATA (synapse/replication/tcp/handler.py:281) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:946);to_string (synapse/types.py:195) 1
on_rdata (synapse/app/generic_worker.py:659) 2
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:233);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:218) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:220);labels (prometheus_client/metrics.py:162) 2
_have_rooms_changed (synapse/handlers/sync.py:1480);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:69) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:779);stopProducing (twisted/web/static.py:755) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);make_deferred_yieldable (synapse/logging/context.py:710);isawaitable (inspect.py:226) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:242);__sub__ (synapse/logging/context.py:175);__init__ (synapse/logging/context.py:116) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);f (synapse/metrics/__init__.py:473);runUntilCurrent (twisted/internet/base.py:935);_tick (twisted/internet/task.py:672);_oneWorkUnit (twisted/internet/task.py:528);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:195);observe (prometheus_client/metrics.py:535) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);getResourceFor (twisted/web/server.py:899);getChildForRequest (twisted/web/resource.py:98) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:119);debug (logging/__init__.py:1361) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:401);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:187);addErrback (twisted/internet/defer.py:333);addCallbacks (twisted/internet/defer.py:311) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:514);callFromThread (twisted/internet/base.py:1032);wakeUp (twisted/internet/base.py:587);wakeUp (twisted/internet/posixbase.py:176);untilConcludes (twisted/python/util.py:815) 4
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:667);__init__ (twisted/python/failure.py:319) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_app_service_by_user_id (synapse/storage/data_stores/main/appservice.py:87) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1146);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2154) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:953);__exit__ (synapse/util/metrics.py:127);get_resource_usage (synapse/logging/context.py:425);copy (synapse/logging/context.py:119) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:148);labels (prometheus_client/metrics.py:162) 1
get_user_filter (synapse/api/filtering.py:145);__init__ (synapse/api/filtering.py:195) 1
_generate_sync_entry_for_to_device (synapse/handlers/sync.py:1225);_trace_inner (synapse/logging/opentracing.py:706);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);__init__ (<attrs generated init twisted.internet.defer._CancellationStatus>:3) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 8
get_user_by_access_token (synapse/api/auth.py:313);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1169);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
get_user_by_req (synapse/api/auth.py:248);insert_client_ip (synapse/replication/slave/storage/client_ips.py:43);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:155) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);write (twisted/web/server.py:275);write (twisted/web/http.py:1176);writeHeaders (twisted/web/http.py:2485);writeSequence (twisted/internet/_newtls.py:204);writeSequence (twisted/internet/abstract.py:384);startWriting (twisted/internet/abstract.py:443);addWriter (twisted/internet/epollreactor.py:127);_add (twisted/internet/epollreactor.py:94) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1033);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:123) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988) 1
_generate_sync_entry_for_to_device (synapse/handlers/sync.py:1225);to_string (synapse/types.py:195) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1934);_wrapped (synapse/util/caches/descriptors.py:443);get (synapse/util/caches/descriptors.py:151) 1
on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:684);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_event (synapse/storage/data_stores/main/events_worker.py:183);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_events_as_list (synapse/storage/data_stores/main/events_worker.py:274);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_cache_or_db (synapse/storage/data_stores/main/events_worker.py:421);unwindGenerator (twisted/internet/defer.py:1604) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:505);new_transaction (synapse/storage/database.py:418);_fetch_event_rows (synapse/storage/data_stores/main/events_worker.py:765) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2485);writeSequence (twisted/internet/_newtls.py:204);writeSequence (twisted/internet/abstract.py:384);startWriting (twisted/internet/abstract.py:443);addWriter (twisted/internet/epollreactor.py:127);_add (twisted/internet/epollreactor.py:94) 11
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);validator_for (jsonschema/validators.py:970);__contains__ (_collections_abc.py:666) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1011) 1
process_and_notify (synapse/app/generic_worker.py:742);on_new_room_event (synapse/notifier.py:240);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:307);__exit__ (synapse/util/metrics.py:135);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:298);getClientIP (synapse/http/site.py:329) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:130);get_request_id (synapse/http/site.py:86);get_method (synapse/http/site.py:107) 1
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:319) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);remove (synapse/util/caches/response_cache.py:101);call_later (synapse/util/__init__.py:98) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);logPrefix (twisted/internet/tcp.py:335) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:132);get_resource_usage (synapse/logging/context.py:425);_get_cputime (synapse/logging/context.py:457) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:130) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1177);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2195);__init__ (inspect.py:2803) 2
get_new_events (synapse/handlers/receipts.py:144);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:459);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);write (twisted/web/server.py:275);write (twisted/web/http.py:1176);writeHeaders (twisted/web/http.py:2485);<genexpr> (twisted/web/http.py:2482) 1
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:106);_process_event_stream_row (synapse/replication/slave/storage/events.py:136);invalidate_caches_for_event (synapse/replication/slave/storage/events.py:168) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:263);run_as_background_process (synapse/metrics/background_process_metrics.py:223);__enter__ (synapse/logging/context.py:531);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
<genexpr> (inspect.py:2800) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1945) 1
get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:315);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);__init__ (synapse/http/site.py:312);__init__ (synapse/http/site.py:72);__init__ (twisted/web/server.py:120) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:162);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:341);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418) 1
compute_state_delta (synapse/handlers/sync.py:934);filter_room_state (synapse/api/filtering.py:225);filter (synapse/api/filtering.py:373) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doWrite (twisted/internet/abstract.py:257);writeSomeData (twisted/internet/tcp.py:275) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:779);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:908);filter (logging/__init__.py:768);filter (synapse/logging/context.py:511);copy_to (synapse/logging/context.py:330) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:526);callFromThread (twisted/internet/base.py:1032);wakeUp (twisted/internet/base.py:587);wakeUp (twisted/internet/posixbase.py:181);untilConcludes (twisted/python/util.py:815) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798);requestDone (twisted/web/http.py:2397) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);_started_processing (synapse/http/site.py:239);get_redacted_uri (synapse/http/site.py:92);redact_uri (synapse/http/__init__.py:50) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:285);get_resource_usage (synapse/logging/context.py:425) 1
get_state_ids_for_events (synapse/storage/state.py:494);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:401);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:186);<listcomp> (synapse/util/async_helpers.py:186);run_in_background (synapse/logging/context.py:640);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1177);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2195) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517) 1
get_user_by_access_token (synapse/api/auth.py:300) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:45);doWork (twisted/_threads/_team.py:194);do (twisted/_threads/_threadworker.py:109) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_set_context_cb (synapse/logging/context.py:719);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403);_get_cputime (synapse/logging/context.py:457) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:133);labels (prometheus_client/metrics.py:149) 1
_have_rooms_changed (synapse/handlers/sync.py:1479);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:84) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:777);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416) 1
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:135);labels (prometheus_client/metrics.py:162) 2
unread_notifs_for_room_id (synapse/handlers/sync.py:951);_wrapped (synapse/util/caches/descriptors.py:459) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:630) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:762) 1
process_and_notify (synapse/app/generic_worker.py:742);on_new_room_event (synapse/notifier.py:240);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:307);__exit__ (synapse/util/metrics.py:135);labels (prometheus_client/metrics.py:162) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:153);labels (prometheus_client/metrics.py:149) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 1
get_rooms_for_user_at (synapse/handlers/sync.py:1959) 2
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:156);inc (prometheus_client/metrics.py:244);inc (prometheus_client/values.py:20) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_users_who_share_room_with_user (synapse/storage/data_stores/main/roommember.py:500);_wrapped (synapse/util/caches/descriptors.py:440);make_deferred_yieldable (synapse/logging/context.py:691);isawaitable (inspect.py:226);__instancecheck__ (abc.py:139) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:925);get_lazy_loaded_members_cache (synapse/handlers/sync.py:737) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);get_current_key (synapse/handlers/receipts.py:147) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:476);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:296);iterencode (simplejson/encoder.py:378) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:128);parse_integer (synapse/http/servlet.py:45);parse_integer_from_args (synapse/http/servlet.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:141);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135);islice (sortedcontainers/sortedlist.py:993);_islice (sortedcontainers/sortedlist.py:1018) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (prometheus_client/metrics.py:73) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:777);stopProducing (twisted/web/static.py:755) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);get (synapse/util/caches/dictionary_cache.py:83) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:449);blocks_all_room_timeline (synapse/api/filtering.py:253);filters_all_types (synapse/api/filtering.py:276) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1169);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);succeed (twisted/internet/defer.py:89) 1
_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);concurrently_execute (synapse/util/async_helpers.py:168);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917);_handle_fromlist (<frozen importlib._bootstrap>:1028) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568) 1
wait_for_events (synapse/notifier.py:353);__enter__ (synapse/logging/context.py:531);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:392) 1
get_user_by_req (synapse/api/auth.py:248);insert_client_ip (synapse/replication/slave/storage/client_ips.py:43);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:222);_encodeValues (twisted/web/http_headers.py:147) 1
get_current_token (synapse/streams/events.py:61);get_current_key (synapse/handlers/typing.py:326);_get (synapse/server.py:594) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_state_groups_from_groups_txn (synapse/storage/data_stores/state/bg_updates.py:129) 1
_have_rooms_changed (synapse/handlers/sync.py:1479);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:85) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:445) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:153);info (logging/__init__.py:1383);_log (logging/__init__.py:1518);findCaller (logging/__init__.py:1456) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1177);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2195);__init__ (inspect.py:2505);__call__ (enum.py:310) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1467) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:891);parse_qs (twisted/web/http.py:211) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:667) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:218);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:133);inc (prometheus_client/metrics.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1945) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1419) 13
_load_filtered_recents (synapse/handlers/sync.py:536);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);f (synapse/metrics/__init__.py:473);observe (prometheus_client/metrics.py:532) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483) 1
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422) 1
_load_filtered_recents (synapse/handlers/sync.py:536);__exit__ (synapse/util/metrics.py:133);get_resource_usage (synapse/logging/context.py:425);copy (synapse/logging/context.py:119);__init__ (synapse/logging/context.py:116) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:374);__enter__ (synapse/util/metrics.py:113);__init__ (synapse/logging/context.py:283) 1
get_user_by_req (synapse/api/auth.py:248);insert_client_ip (synapse/replication/slave/storage/client_ips.py:43);get (synapse/util/caches/descriptors.py:151) 1
wait_for_events (synapse/notifier.py:353);new_listener (synapse/notifier.py:140);is_after (synapse/types.py:389);room_stream_id (synapse/types.py:374) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);inContext (twisted/python/threadpool.py:261);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);new_transaction (synapse/storage/database.py:503);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);notify (threading.py:356);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:323) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);__lt__ (twisted/internet/base.py:181) 1
wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);gatherResults (twisted/internet/defer.py:1181);__init__ (twisted/internet/defer.py:1099);addCallbacks (twisted/internet/defer.py:311);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);send (twisted/internet/defer.py:751) 1
new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);wrapped (synapse/util/caches/descriptors.py:622);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159) 1
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:268);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1038);flush (logging/__init__.py:1018) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);make_deferred_yieldable (synapse/logging/context.py:708) 3
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);f (synapse/storage/data_stores/main/stream.py:399);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 12
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 3
_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);start (twisted/web/static.py:765);registerProducer (twisted/web/http.py:987) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 2
iter_errors (jsonschema/validators.py:296);anyOf (jsonschema/_validators.py:329);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);resolve (jsonschema/validators.py:766) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:350) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_user_by_req (synapse/api/auth.py:205);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_user_by_access_token (synapse/api/auth.py:300);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1511) 1
_enqueue_events (synapse/storage/data_stores/main/events_worker.py:686);notify (threading.py:354) 1
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121);_process_event_stream_row (synapse/replication/slave/storage/events.py:148);invalidate_caches_for_event (synapse/replication/slave/storage/events.py:180);invalidate_many (synapse/util/caches/descriptors.py:253);inner (synapse/util/caches/lrucache.py:97);cache_del_multi (synapse/util/caches/lrucache.py:221);delete_node (synapse/util/caches/lrucache.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:323);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:292);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:702);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:458);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:251) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:762);__getitem__ (frozendict/__init__.py:29) 6
_generate_sync_entry_for_groups (synapse/handlers/sync.py:1098);__init__ (<attrs generated init synapse.handlers.sync.GroupsSyncResult>:5) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_cbDeferred (twisted/internet/defer.py:1121);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:476) 1
unread_notifs_for_room_id (synapse/handlers/sync.py:953);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159);get (synapse/util/caches/treecache.py:35) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);parse_command_from_line (synapse/replication/tcp/commands.py:492);from_line (synapse/replication/tcp/commands.py:134) 1
on_RDATA (synapse/replication/tcp/handler.py:281);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);get_integration (sentry_sdk/hub.py:257) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:387);get_new_events (synapse/handlers/typing.py:323);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:572);get_thread_resource_usage (synapse/logging/context.py:55) 1
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);concurrently_execute (synapse/util/async_helpers.py:168);addErrback (twisted/internet/defer.py:333);addCallbacks (twisted/internet/defer.py:311);_runCallbacks (twisted/internet/defer.py:711) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:401);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:186);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917);iscoroutine (asyncio/coroutines.py:186);__instancecheck__ (abc.py:139) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:401);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:189);gatherResults (twisted/internet/defer.py:1183);__init__ (twisted/internet/defer.py:1100);__init__ (twisted/internet/defer.py:290) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:415) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2485);writeSequence (twisted/internet/_newtls.py:204) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v1/events.py:64);wrapped (synapse/logging/utils.py:64);getLogger (logging/__init__.py:1937);getLogger (logging/__init__.py:1233) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:762);__getitem__ (frozendict/__init__.py:29) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);resolve_state_groups_for_events (synapse/state/__init__.py:394);__init__ (synapse/state/__init__.py:77);__init__ (frozendict/__init__.py:25) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);resetTimeout (twisted/protocols/policies.py:713) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 15
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:447);maybeDeferred (twisted/internet/defer.py:151);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:640);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_users_who_share_room_with_user (synapse/storage/data_stores/main/roommember.py:500) 2
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);run (synapse/metrics/background_process_metrics.py:220);update_metrics (synapse/metrics/background_process_metrics.py:156) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1399);_get_rooms_changed (synapse/handlers/sync.py:1662);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:8) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:328) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672) 17
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);_started_processing (synapse/http/site.py:239);start (synapse/http/request_metrics.py:160);current_context (synapse/logging/context.py:554) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:505);new_transaction (synapse/storage/database.py:418);_fetch_event_rows (synapse/storage/data_stores/main/events_worker.py:746);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);decode (encodings/utf_8.py:16) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:238) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:231);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:217);update_metrics (synapse/metrics/background_process_metrics.py:156);get_resource_usage (synapse/logging/context.py:425) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:925);from_lazy_load_member_list (synapse/storage/state.py:111) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2475);__init__ (twisted/web/http_headers.py:79) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);get_user_by_req (synapse/api/auth.py:188);get_ip_from_request (synapse/server.py:291);getClientIP (synapse/http/site.py:329);getRawHeaders (twisted/web/http_headers.py:266) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);_started_processing (synapse/http/site.py:239) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:779);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:233);__sub__ (synapse/logging/context.py:175) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:777);finish (synapse/http/site.py:185);__exit__ (synapse/logging/context.py:544);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403);_get_cputime (synapse/logging/context.py:457) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:233) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:233);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:217);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:268);warning (logging/__init__.py:1395);_log (logging/__init__.py:1507) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doWrite (twisted/internet/abstract.py:257);writeSomeData (twisted/internet/tcp.py:275);untilConcludes (twisted/python/util.py:815) 10
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:218);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:304);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_wait_for_sync_for_user (synapse/handlers/sync.py:336);labels (prometheus_client/metrics.py:162) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);count_listeners (synapse/notifier.py:196) 5
_get_state_groups_from_groups (synapse/storage/data_stores/state/store.py:159);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runInteraction (synapse/storage/database.py:524);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1177) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1034);format (logging/__init__.py:880);format (logging/__init__.py:619);formatTime (logging/__init__.py:562) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);<dictcomp> (synapse/http/server.py:323) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2485);addRawHeader (twisted/web/http_headers.py:242);setRawHeaders (twisted/web/http_headers.py:222) 1
runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291);deferToThreadPool (twisted/internet/threads.py:55);callInThreadWithCallback (twisted/python/threadpool.py:269);do (twisted/_threads/_team.py:166);do (twisted/_threads/_threadworker.py:114) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:946);_wrapped (synapse/util/caches/descriptors.py:447) 1
wait_for_events (synapse/notifier.py:353);send (twisted/internet/defer.py:743) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1647) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);_tick (twisted/internet/task.py:672);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:779);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:208);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:777);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:242);get_resource_usage (synapse/logging/context.py:425);copy (synapse/logging/context.py:119);__init__ (synapse/logging/context.py:116) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:925);__exit__ (synapse/util/metrics.py:124) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);__init__ (jsonschema/validators.py:289);from_schema (jsonschema/validators.py:682);__init__ (jsonschema/validators.py:664);__setitem__ (jsonschema/_utils.py:25);normalize (jsonschema/_utils.py:15);geturl (urllib/parse.py:321);urlunsplit (urllib/parse.py:494);_coerce_args (urllib/parse.py:122) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:762) 9
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1033);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_groups (synapse/handlers/sync.py:1098) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 4
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);get_events_as_list (synapse/storage/data_stores/main/events_worker.py:361) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:236);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 1
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:136);islice (sortedcontainers/sortedlist.py:993);_pos (sortedcontainers/sortedlist.py:688) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);start (twisted/web/static.py:765);registerProducer (twisted/web/http.py:987);registerProducer (twisted/web/http.py:2581);startStreaming (twisted/internet/_producer_helpers.py:90) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);get_user_filter (synapse/api/filtering.py:145);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:159);move_node_to_front (synapse/util/caches/lrucache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:708);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1945) 2
_generate_sync_entry_for_groups (synapse/handlers/sync.py:1098);get_groups_changes_for_user (synapse/storage/data_stores/main/group_server.py:438) 1
encode_room (synapse/rest/client/v2_alpha/sync.py:421);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:189);addErrback (twisted/internet/defer.py:333);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 3
get_new_events (synapse/handlers/receipts.py:144);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);get_entities_changed (synapse/util/caches/stream_change_cache.py:98);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);gatherResults (twisted/internet/defer.py:1181);__init__ (twisted/internet/defer.py:1099) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);make_deferred_yieldable (synapse/logging/context.py:708);ensureDeferred (twisted/internet/defer.py:905) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);parse_command_from_line (synapse/replication/tcp/commands.py:492);from_line (synapse/replication/tcp/commands.py:134);loads (simplejson/__init__.py:525);decode (simplejson/decoder.py:370) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2475);writeSequence (twisted/internet/_newtls.py:204);writeSequence (twisted/internet/abstract.py:384);startWriting (twisted/internet/abstract.py:443) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:186);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);make_deferred_yieldable (synapse/logging/context.py:710);ensureDeferred (twisted/internet/defer.py:917);iscoroutine (asyncio/coroutines.py:186) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:458);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 2
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291);deferToThreadPool (twisted/internet/threads.py:53);callInThreadWithCallback (twisted/python/threadpool.py:266) 1
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:133);labels (prometheus_client/metrics.py:162) 2
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:134) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:910) 2
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);headerReceived (twisted/web/http.py:2242);setRawHeaders (twisted/web/http_headers.py:219);_encodeValues (twisted/web/http_headers.py:147) 1
get_user_filter (synapse/api/filtering.py:145);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:917);iscoroutine (asyncio/coroutines.py:186) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:134) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);<lambda> (synapse/notifier.py:209);count (synapse/notifier.py:51) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);push_scope (jsonschema/validators.py:692);urljoin (urllib/parse.py:515);urlunparse (urllib/parse.py:475) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1169);unwindGenerator (twisted/internet/defer.py:1613) 1
unread_notifs_for_room_id (synapse/handlers/sync.py:951);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:710);ensureDeferred (twisted/internet/defer.py:917);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:559);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2253);setRawHeaders (twisted/web/http_headers.py:218);_encodeName (twisted/web/http_headers.py:114) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_do_execute (synapse/storage/database.py:243);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421) 1
measured_func (synapse/util/metrics.py:74);__exit__ (synapse/util/metrics.py:131) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:995);get_rooms_for_user_at (synapse/handlers/sync.py:1934);_wrapped (synapse/util/caches/descriptors.py:443);get (synapse/util/caches/descriptors.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:231) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:298);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:908);emit (sentry_sdk/integrations/logging.py:227);_emit (sentry_sdk/integrations/logging.py:235);add_breadcrumb (sentry_sdk/hub.py:399) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:908);emit (sentry_sdk/integrations/logging.py:227);format (logging/__init__.py:880);format (logging/__init__.py:622) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:708);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);__enter__ (synapse/logging/context.py:531);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:166) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1156);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:545);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:134);islice (sortedcontainers/sortedlist.py:978) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155) 1
encode_response (synapse/rest/client/v2_alpha/sync.py:231);to_string (synapse/types.py:367);<listcomp> (synapse/types.py:367) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1016);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:445);wrapped (synapse/util/caches/descriptors.py:563);getcallargs (inspect.py:1354) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:124);get_resource_usage (synapse/logging/context.py:419) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:459) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_users_who_share_room_with_user (synapse/storage/data_stores/main/roommember.py:498) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);helper (contextlib.py:239);__init__ (contextlib.py:88) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:458);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:394);__init__ (synapse/state/__init__.py:77);__init__ (frozendict/__init__.py:25) 2
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);delete_messages_for_device_txn (synapse/storage/data_stores/main/deviceinbox.py:109);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407) 2
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:136);islice (sortedcontainers/sortedlist.py:993);_islice (sortedcontainers/sortedlist.py:1018) 1
get_user_by_access_token (synapse/api/auth.py:313);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_look_up_user_by_access_token (synapse/api/auth.py:469);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:894);wakeUp (twisted/internet/base.py:587);wakeUp (twisted/internet/posixbase.py:176);untilConcludes (twisted/python/util.py:815) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2485);addRawHeader (twisted/web/http_headers.py:242);getRawHeaders (twisted/web/http_headers.py:266) 1
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121);process_replication_rows (synapse/replication/slave/storage/room.py:42);process_replication_rows (synapse/replication/slave/storage/presence.py:60);process_replication_rows (synapse/replication/slave/storage/_base.py:86) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);start (twisted/web/static.py:765);registerProducer (twisted/web/http.py:987);registerProducer (twisted/web/http.py:2581) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:245) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);set_state (synapse/app/generic_worker.py:321);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);inContext (twisted/python/threadpool.py:261);f (synapse/storage/data_stores/main/stream.py:402);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);get_user_by_req (synapse/api/auth.py:243);to_string (synapse/types.py:195) 1
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121);process_replication_rows (synapse/replication/slave/storage/room.py:42);process_replication_rows (synapse/replication/slave/storage/presence.py:60);process_replication_rows (synapse/replication/slave/storage/_base.py:86);_invalidate_state_caches (synapse/storage/_base.py:65);_attempt_to_invalidate_cache (synapse/storage/_base.py:84);<lambda> (synapse/util/caches/descriptors.py:464);invalidate (synapse/util/caches/descriptors.py:229) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);filter_room_ephemeral (synapse/api/filtering.py:231);filter (synapse/api/filtering.py:373);check (synapse/api/filtering.py:319);check_fields (synapse/api/filtering.py:336) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:372) 1
runWithConnection (synapse/storage/database.py:583);make_deferred_yieldable (synapse/logging/context.py:710);ensureDeferred (twisted/internet/defer.py:917);iscoroutine (asyncio/coroutines.py:186);__instancecheck__ (abc.py:139) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2101);headerReceived (twisted/web/http.py:2253);setRawHeaders (twisted/web/http_headers.py:222);_encodeName (twisted/web/http_headers.py:114) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1934);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:696) 1
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);make_deferred_yieldable (synapse/logging/context.py:708);isawaitable (inspect.py:226) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 5
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:260);resolve (jsonschema/validators.py:766);urljoin (urllib/parse.py:524);urlparse (urllib/parse.py:375);urlsplit (urllib/parse.py:420) 1
generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);gatherResults (twisted/internet/defer.py:1183);__init__ (twisted/internet/defer.py:1100);addCallbacks (twisted/internet/defer.py:311);_runCallbacks (twisted/internet/defer.py:711);_cbDeferred (twisted/internet/defer.py:1121) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1011);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 3
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:711) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:514);set_cors_headers (synapse/http/server.py:531);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:220) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:119);send (twisted/internet/defer.py:751) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_set_context_cb (synapse/logging/context.py:719);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:161) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);maybe_awaitable (synapse/util/async_helpers.py:516) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1668) 3
_have_rooms_changed (synapse/handlers/sync.py:1480);has_room_changed_since (synapse/storage/data_stores/main/stream.py:815);has_entity_changed (synapse/util/caches/stream_change_cache.py:71) 1
_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1278);have_push_rules_changed_for_user (synapse/storage/data_stores/main/push_rule.py:139);has_entity_changed (synapse/util/caches/stream_change_cache.py:85);inc_hits (synapse/util/caches/__init__.py:84) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711) 1
get_user_by_req (synapse/api/auth.py:248);insert_client_ip (synapse/replication/slave/storage/client_ips.py:48);send_user_ip (synapse/replication/tcp/handler.py:489);send_command (synapse/replication/tcp/handler.py:448);send_command (synapse/replication/tcp/protocol.py:315);sendLine (twisted/protocols/basic.py:476);writeSequence (twisted/internet/_newtls.py:204);writeSequence (twisted/internet/abstract.py:384);startWriting (twisted/internet/abstract.py:443);addWriter (twisted/internet/epollreactor.py:127);_add (twisted/internet/epollreactor.py:94) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2153);headerReceived (twisted/web/http.py:2260);setRawHeaders (twisted/web/http_headers.py:222);_encodeName (twisted/web/http_headers.py:114) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:777);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165) 1
handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:259);queue (synapse/util/async_helpers.py:239);_await_lock (synapse/util/async_helpers.py:289);make_deferred_yieldable (synapse/logging/context.py:708);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2253);setRawHeaders (twisted/web/http_headers.py:220) 1
_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1453);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:630) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1156);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:545);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 6
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:194);do (twisted/_threads/_threadworker.py:106) 2
get_current_token (synapse/streams/events.py:61);get_current_key (synapse/handlers/room.py:1044);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1419) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:779);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:229) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:346);new_listener (synapse/notifier.py:140) 1
_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_do_execute (synapse/storage/database.py:243);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);new_transaction (synapse/storage/database.py:503);untilConcludes (twisted/python/util.py:815);_runCallbacks (twisted/internet/defer.py:711);on_GET (synapse/rest/client/v2_alpha/sync.py:186);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);get_new_messages_for_device_txn (synapse/storage/data_stores/main/deviceinbox.py:70);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);get_new_messages_for_device_txn (synapse/storage/data_stores/main/deviceinbox.py:70);get_new_messages_for_device_txn (synapse/storage/data_stores/main/deviceinbox.py:70);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);get_new_messages_for_device_txn (synapse/storage/data_stores/main/deviceinbox.py:70);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);_do_fetch (synapse/storage/data_stores/main/events_worker.py:481);_fetch_event_list (synapse/storage/data_stores/main/events_worker.py:505);new_transaction (synapse/storage/database.py:419);_fetch_event_rows (synapse/storage/data_stores/main/events_worker.py:728);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:158);labels (prometheus_client/metrics.py:162) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:258);onResult (twisted/internet/threads.py:49);callFromThread (twisted/internet/base.py:1032);wakeUp (twisted/internet/base.py:587);wakeUp (twisted/internet/posixbase.py:176);untilConcludes (twisted/python/util.py:815) 13
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:528);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:162);__sub__ (synapse/logging/context.py:175);__init__ (synapse/logging/context.py:116) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 12
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 7
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 6
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 2
getAllRawHeaders (twisted/web/http_headers.py:276);_canonicalNameCaps (twisted/web/http_headers.py:290);_dashCapitalize (twisted/web/http_headers.py:24) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:458);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:239) 1
on_RDATA (synapse/replication/tcp/handler.py:281);warning (logging/__init__.py:1395);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:908);emit (sentry_sdk/integrations/logging.py:227);_emit (sentry_sdk/integrations/logging.py:235);add_breadcrumb (sentry_sdk/hub.py:399) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:694);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:910) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2260);setRawHeaders (twisted/web/http_headers.py:222) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);makeRecord (logging/__init__.py:1494);__init__ (logging/__init__.py:361) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:629);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:951);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
<genexpr> (synapse/visibility.py:81);event_id (synapse/events/__init__.py:466);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1848);filter_room_ephemeral (synapse/api/filtering.py:231);filter (synapse/api/filtering.py:373);check (synapse/api/filtering.py:305) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2125) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);parse_qs (twisted/web/http.py:217);unquote_to_bytes (urllib/parse.py:592) 1
_get_appservice_user_id (synapse/api/auth.py:259);get_app_service_by_token (synapse/storage/data_stores/main/appservice.py:100) 1
get_new_events (synapse/handlers/receipts.py:144);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1177);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2195);__init__ (inspect.py:2800) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);__enter__ (synapse/logging/context.py:531);set_current_context (synapse/logging/context.py:577);start (synapse/logging/context.py:362) 1
_enqueue_events (synapse/storage/data_stores/main/events_worker.py:686);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:203);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:905);acquire (logging/__init__.py:854) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);push_scope (jsonschema/validators.py:692);urljoin (urllib/parse.py:515);urlunparse (urllib/parse.py:475);urlunsplit (urllib/parse.py:494);_coerce_args (urllib/parse.py:119) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:128) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:779);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);update_metrics (synapse/http/request_metrics.py:242);labels (prometheus_client/metrics.py:151) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);delete_node (synapse/util/caches/lrucache.py:151);cache_pop (synapse/util/caches/lrucache.py:208);inner (synapse/util/caches/lrucache.py:97);invalidate (synapse/util/caches/descriptors.py:240);_inlineCallbacks (twisted/internet/defer.py:1422);run (synapse/metrics/background_process_metrics.py:220);update_metrics (synapse/metrics/background_process_metrics.py:155) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:288) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);copy_and_advance (synapse/types.py:404);copy_and_replace (synapse/types.py:409);_replace (collections/__init__.py:414) 1
on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70);process_replication_rows (synapse/replication/slave/storage/receipts.py:69);process_replication_rows (synapse/replication/slave/storage/push_rule.py:53);process_replication_rows (synapse/replication/slave/storage/groups.py:52);process_replication_rows (synapse/replication/slave/storage/account_data.py:63);process_replication_rows (synapse/replication/slave/storage/pushers.py:43);process_replication_rows (synapse/replication/slave/storage/events.py:121) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:323);__enter__ (synapse/util/metrics.py:113);time (synapse/util/__init__.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:7) 1
filter_events_for_client (synapse/visibility.py:257);wrapped (synapse/util/caches/descriptors.py:622);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1177);_signature_from_callable (inspect.py:2284);_signature_from_function (inspect.py:2195);__init__ (inspect.py:2505);__call__ (enum.py:310);__new__ (enum.py:532) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:84) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_set_context_cb (synapse/logging/context.py:719);set_current_context (synapse/logging/context.py:577);start (synapse/logging/context.py:362) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798);requestDone (twisted/web/http.py:2397);setTimeout (twisted/protocols/policies.py:737) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);get_new_events (synapse/handlers/typing.py:323);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:577);current_context (synapse/logging/context.py:554) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:298);get_resource_usage (synapse/logging/context.py:425) 1
get_user_by_access_token (synapse/api/auth.py:313);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);_look_up_user_by_access_token (synapse/api/auth.py:469);_wrapped (synapse/util/caches/descriptors.py:443) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2147) 1
get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:148);wrapped (synapse/util/caches/descriptors.py:622);succeed (twisted/internet/defer.py:90);__init__ (twisted/internet/defer.py:290) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:312);_get_handler_for_request (synapse/http/server.py:361) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_room (synapse/storage/data_stores/main/stream.py:410) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);__lt__ (twisted/internet/base.py:174) 1
process_and_notify (synapse/app/generic_worker.py:742);on_new_room_event (synapse/notifier.py:240) 1
delete_messages_for_device (synapse/storage/data_stores/main/deviceinbox.py:101);get (synapse/util/caches/expiringcache.py:127);__getitem__ (synapse/util/caches/expiringcache.py:105) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1169);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:136) 1
unread_notifs_for_room_id (synapse/handlers/sync.py:953) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1176);writeHeaders (twisted/web/http.py:2485);writeSequence (twisted/internet/_newtls.py:204);writeSequence (twisted/internet/abstract.py:384);startWriting (twisted/internet/abstract.py:443);addWriter (twisted/internet/epollreactor.py:127);_add (twisted/internet/epollreactor.py:94) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798);requestDone (twisted/web/http.py:2390) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 2
_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:331);<listcomp> (synapse/storage/data_stores/main/stream.py:331);run_in_background (synapse/logging/context.py:640);set_current_context (synapse/logging/context.py:572);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 2
new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:657);on_rdata (synapse/replication/tcp/client.py:101);process_replication_rows (synapse/replication/slave/storage/deviceinbox.py:64);process_replication_rows (synapse/replication/slave/storage/devices.py:70) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:231);to_string (synapse/types.py:367);<listcomp> (synapse/types.py:367) 1
encode_room (synapse/rest/client/v2_alpha/sync.py:421);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:189);gatherResults (twisted/internet/defer.py:1183);__init__ (twisted/internet/defer.py:1084);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);remove (synapse/util/caches/response_cache.py:105);call_later (synapse/util/__init__.py:99) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);makeRecord (logging/__init__.py:1494);__init__ (logging/__init__.py:342) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:946);__enter__ (synapse/util/metrics.py:114);time (synapse/util/__init__.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_generate_room_entry (synapse/handlers/sync.py:1898) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1011);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);to_string (synapse/types.py:195) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);headerReceived (twisted/web/http.py:2253) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:627);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);set (synapse/util/caches/response_cache.py:108);__init__ (synapse/util/async_helpers.py:91) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);get_redacted_uri (synapse/http/site.py:92);redact_uri (synapse/http/__init__.py:51) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);headerReceived (twisted/web/http.py:2260);setRawHeaders (twisted/web/http_headers.py:218);_encodeValues (twisted/web/http_headers.py:147) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:231);getResourceFor (twisted/web/server.py:899) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:307);stop (synapse/http/request_metrics.py:213);labels (prometheus_client/metrics.py:153) 1
sleep (synapse/util/__init__.py:50);callLater (twisted/internet/base.py:795);__init__ (twisted/internet/base.py:77) 1
ensureDeferred (twisted/internet/defer.py:911);_inlineCallbacks (twisted/internet/defer.py:1483);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);__init__ (<attrs generated init twisted.internet.defer._CancellationStatus>:3) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:930);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:327) 1
_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:551);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_enqueue_events (synapse/storage/data_stores/main/events_worker.py:681);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:193) 1
runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291);deferToThreadPool (twisted/internet/threads.py:55);callInThreadWithCallback (twisted/python/threadpool.py:269);do (twisted/_threads/_team.py:166);do (twisted/_threads/_threadworker.py:114);<lambda> (twisted/_threads/_team.py:166);_coordinateThisTask (twisted/_threads/_team.py:187);do (twisted/_threads/_threadworker.py:57);put (queue.py:151);notify (threading.py:356) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2147);headerReceived (twisted/web/http.py:2253);setRawHeaders (twisted/web/http_headers.py:222);_encodeValues (twisted/web/http_headers.py:147);_encodeValue (twisted/web/http_headers.py:129) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:511);set_cors_headers (synapse/http/server.py:525) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1946) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);headerReceived (twisted/web/http.py:2249);setRawHeaders (twisted/web/http_headers.py:222) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:8) 2
ref (jsonschema/_validators.py:266);descend (jsonschema/validators.py:349);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349);ref (jsonschema/_validators.py:266);iter_errors (jsonschema/validators.py:341);descend (jsonschema/validators.py:349) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);__init__ (<attrs generated init twisted.internet.defer._CancellationStatus>:3) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:946);__enter__ (synapse/util/metrics.py:114) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:298) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:139);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);addBoth (twisted/internet/defer.py:345) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);__enter__ (synapse/util/metrics.py:114);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:573) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:629);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 5
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:258);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_runWithConnection (twisted/enterprise/adbapi.py:299);inner_func (synapse/storage/database.py:580);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_account_data (synapse/handlers/sync.py:1272) 1
run (synapse/metrics/background_process_metrics.py:220);update_metrics (synapse/metrics/background_process_metrics.py:162);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);__enter__ (contextlib.py:112) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1483);get_state_for_events (synapse/storage/state.py:445);wrapped (synapse/util/caches/descriptors.py:620);gatherResults (twisted/internet/defer.py:1181) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:669) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:925);inner (synapse/util/caches/lrucache.py:97);cache_set (synapse/util/caches/lrucache.py:190) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:161);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:925);inner (synapse/util/caches/lrucache.py:97);cache_set (synapse/util/caches/lrucache.py:190);add_node (synapse/util/caches/lrucache.py:123) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);headerReceived (twisted/web/http.py:2260) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/protocols/basic.py:456);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);addBoth (twisted/internet/defer.py:345) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1784) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1485);get_state_for_events (synapse/storage/state.py:445);wrapped (synapse/util/caches/descriptors.py:563);getcallargs (inspect.py:1385);getfullargspec (inspect.py:1126);_signature_from_callable (inspect.py:2284) 1
encode_room (synapse/rest/client/v2_alpha/sync.py:421);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:187);<listcomp> (synapse/util/async_helpers.py:186);run_in_background (synapse/logging/context.py:655);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:296);iterencode (simplejson/encoder.py:378) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:946);_wrapped (synapse/util/caches/descriptors.py:438);get (synapse/util/caches/descriptors.py:151);inner (synapse/util/caches/lrucache.py:94) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1667);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:8) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);copy_and_replace (synapse/types.py:409);_replace (collections/__init__.py:417);_make (collections/__init__.py:406) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_get_events_from_cache_or_db (synapse/storage/data_stores/main/events_worker.py:426);_get_events_from_cache (synapse/storage/data_stores/main/events_worker.py:453) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);wrapped (synapse/util/caches/descriptors.py:622);get (synapse/util/caches/descriptors.py:154) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);ephemeral_by_room (synapse/handlers/sync.py:415);__exit__ (synapse/util/metrics.py:130);get_resource_usage (synapse/logging/context.py:425);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:130);__enter__ (synapse/logging/context.py:528) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);f (synapse/metrics/__init__.py:473);observe (prometheus_client/metrics.py:535) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1411);_generate_room_entry (synapse/handlers/sync.py:1758) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 6
wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:694);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);run_in_background (synapse/logging/context.py:674);set_current_context (synapse/logging/context.py:577);start (synapse/logging/context.py:362) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);_have_rooms_changed (synapse/handlers/sync.py:1478);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1419);get_membership_changes_for_user (synapse/storage/data_stores/main/stream.py:434) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_get_events_from_db (synapse/storage/data_stores/main/events_worker.py:648);make_event_from_dict (synapse/events/__init__.py:503);__init__ (synapse/events/__init__.py:352) 1
get_rooms_for_user_at (synapse/handlers/sync.py:1959);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:908) 1
get_current_token (synapse/streams/events.py:61);get_current_key (synapse/handlers/room.py:1044);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:401);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:186);<listcomp> (synapse/util/async_helpers.py:186);run_in_background (synapse/logging/context.py:640);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1511);_inlineCallbacks (twisted/internet/defer.py:1418);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421);get_user_by_access_token (synapse/api/auth.py:300);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:182);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:787);requestDone (twisted/web/http.py:2395);setLineMode (twisted/protocols/basic.py:600);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);check_valid_filter (synapse/api/filtering.py:170);validate (jsonschema/validators.py:931);check_schema (jsonschema/validators.py:293);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:341);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);ref (jsonschema/_validators.py:263);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);properties (jsonschema/_validators.py:286);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:328);additionalProperties (jsonschema/_validators.py:49);descend (jsonschema/validators.py:344);iter_errors (jsonschema/validators.py:341) 1
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);ensureDeferred (twisted/internet/defer.py:911);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421) 1
run (synapse/metrics/background_process_metrics.py:220);update_metrics (synapse/metrics/background_process_metrics.py:158) 1
process_and_notify (synapse/app/generic_worker.py:742);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);__init__ (<attrs generated init twisted.internet.defer._CancellationStatus>:3) 1
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135);islice (sortedcontainers/sortedlist.py:985) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allHeadersReceived (twisted/web/http.py:2327);checkPersistence (twisted/web/http.py:2369) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:447);maybeDeferred (twisted/internet/defer.py:151);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:640);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_users_who_share_room_with_user (synapse/storage/data_stores/main/roommember.py:500) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);check_auth_blocking (synapse/api/auth.py:691);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inc_hits (synapse/util/caches/__init__.py:84) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);errback (twisted/internet/defer.py:501);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1156);_wrapped (synapse/util/caches/descriptors.py:459);get_instance (synapse/util/caches/descriptors.py:659) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159) 20
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1789) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:96) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421);get_membership_changes_for_user (synapse/storage/data_stores/main/stream.py:426) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024) 1
get_membership_changes_for_user (synapse/storage/data_stores/main/stream.py:437);parse_stream_token (synapse/types.py:456) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 9
wait_for_sync_for_user (synapse/handlers/sync.py:291);wrap (synapse/util/caches/response_cache.py:158);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:905);acquire (logging/__init__.py:854) 1
get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:619);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:779);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:213);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:258) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:217);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);__enter__ (synapse/logging/context.py:299);set_current_context (synapse/logging/context.py:577);start (synapse/logging/context.py:362) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2167);headerReceived (twisted/web/http.py:2249) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672) 2
unread_notifs_for_room_id (synapse/handlers/sync.py:953);__exit__ (synapse/util/metrics.py:135);inc (prometheus_client/metrics.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1169);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1383) 1
encode_joined (synapse/rest/client/v2_alpha/sync.py:281);encode_room (synapse/rest/client/v2_alpha/sync.py:408);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:186);addErrback (twisted/internet/defer.py:333);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:711) 1
ephemeral_by_room (synapse/handlers/sync.py:417);__exit__ (synapse/util/metrics.py:135);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:229);labels (prometheus_client/metrics.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:256) 4
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:263);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:311);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1469) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:634);_wrapped (synapse/util/caches/descriptors.py:438);get_cache_key (synapse/util/caches/descriptors.py:415) 1
serialize_event (synapse/events/utils.py:402);serialize_event (synapse/events/utils.py:325);event_id (synapse/events/__init__.py:466);_handle_fromlist (<frozen importlib._bootstrap>:1044) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:670);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2485);<genexpr> (twisted/web/http.py:2480);getAllRawHeaders (twisted/web/http_headers.py:276);_canonicalNameCaps (twisted/web/http_headers.py:290) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);getResourceFor (twisted/web/server.py:899);copy (copy.py:76) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:415);copy_and_replace (synapse/types.py:409);_replace (collections/__init__.py:417);_make (collections/__init__.py:408) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);__enter__ (synapse/logging/context.py:531);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:151);run_in_background (synapse/logging/context.py:674) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:401);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:186);make_deferred_yieldable (synapse/logging/context.py:704);ensureDeferred (twisted/internet/defer.py:908) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:385);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:124);unregister (synapse/metrics/__init__.py:158) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2481) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1030);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:131);__exit__ (synapse/logging/context.py:319);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);<lambda> (synapse/notifier.py:209);count (synapse/notifier.py:50) 1
_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);iscoroutine (asyncio/coroutines.py:176) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1146);_wrapped (synapse/util/caches/descriptors.py:459);get_instance (synapse/util/caches/descriptors.py:659);setdefault (weakref.py:279) 1
process_and_notify (synapse/app/generic_worker.py:742);on_new_room_event (synapse/notifier.py:240);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:307);__exit__ (synapse/util/metrics.py:128);get_resource_usage (synapse/logging/context.py:422);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);insert_client_ip (synapse/replication/slave/storage/client_ips.py:48);send_user_ip (synapse/replication/tcp/handler.py:489);send_command (synapse/replication/tcp/handler.py:448) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:254) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1399);_get_rooms_changed (synapse/handlers/sync.py:1672);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:4) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);finish (twisted/web/server.py:286);finish (twisted/web/http.py:1101);_cleanup (twisted/web/http.py:798);requestDone (twisted/web/http.py:2384) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1477);get_state_for_events (synapse/storage/state.py:445);wrapped (synapse/util/caches/descriptors.py:563) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);f (synapse/metrics/__init__.py:473);runUntilCurrent (twisted/internet/base.py:935);_tick (twisted/internet/task.py:670) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);wait_for_events (synapse/notifier.py:375);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:118) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149);_wrapped (synapse/util/caches/descriptors.py:459);make_deferred_yieldable (synapse/logging/context.py:704);isawaitable (inspect.py:226) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);unregisterProducer (twisted/web/http.py:994);unregisterProducer (twisted/web/http.py:2597);stopStreaming (twisted/internet/_producer_helpers.py:103);stop (twisted/internet/task.py:498);__init__ (twisted/python/failure.py:398) 2
_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);simple_select_onecol_txn (synapse/storage/database.py:1057);simple_select_one_onecol_txn (synapse/storage/database.py:1040);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_async_render (synapse/http/server.py:335);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);__exit__ (contextlib.py:119);_ctx_manager (synapse/util/async_helpers.py:262) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);ensureDeferred (twisted/internet/defer.py:911);run_in_background (synapse/logging/context.py:674);set_current_context (synapse/logging/context.py:577);get_thread_resource_usage (synapse/logging/context.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);_wait_for_sync_for_user (synapse/handlers/sync.py:326) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);get_new_events (synapse/handlers/typing.py:323);__exit__ (synapse/util/metrics.py:135);labels (prometheus_client/metrics.py:162) 3
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1784) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:888);parse_qs (twisted/web/http.py:216) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:296);iterencode (simplejson/encoder.py:378) 1
get_user_by_req (synapse/api/auth.py:248) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:259);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:689);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 3
get_current_token (synapse/streams/events.py:55) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:166);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:655);ensureDeferred (twisted/internet/defer.py:908);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1034);format (logging/__init__.py:880);format (logging/__init__.py:621);formatMessage (logging/__init__.py:591) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68) 3
_look_up_user_by_access_token (synapse/api/auth.py:483);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:157) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);wrapped_callback (synapse/util/__init__.py:96) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:134) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:107);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);cancel_timeout (synapse/util/async_helpers.py:477);cancel (twisted/internet/base.py:105) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v1/events.py:64);get_stream (synapse/handlers/events.py:98);get_events_for (synapse/notifier.py:403);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_room_ids (synapse/notifier.py:484);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_is_world_readable (synapse/notifier.py:492);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state (synapse/state/__init__.py:135);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:251) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);_get_in_flight_counts (synapse/http/request_metrics.py:128);update_metrics (synapse/http/request_metrics.py:241);get_resource_usage (synapse/logging/context.py:425);copy (synapse/logging/context.py:119) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 6
get_user_by_req (synapse/api/auth.py:188);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2153);headerReceived (twisted/web/http.py:2249);setRawHeaders (twisted/web/http_headers.py:214);_encodeName (twisted/web/http_headers.py:114) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68) 1
<genexpr> (prometheus_client/metrics.py:151) 10
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:218);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:87);_doReadOrWrite (twisted/internet/posixbase.py:619);doWrite (twisted/internet/abstract.py:257);writeSomeData (twisted/internet/tcp.py:275);untilConcludes (twisted/python/util.py:815) 1
get_state_ids_for_events (synapse/storage/state.py:494);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2260) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);delete_node (synapse/util/caches/lrucache.py:151);cache_pop (synapse/util/caches/lrucache.py:208);inner (synapse/util/caches/lrucache.py:97);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:217);update_metrics (synapse/metrics/background_process_metrics.py:156) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);_insertNewDelayedCalls (twisted/internet/base.py:841) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421);check_auth_blocking (synapse/api/auth.py:702);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:134);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:245) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:281);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:691);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 6
getAllRawHeaders (twisted/web/http_headers.py:276);_canonicalNameCaps (twisted/web/http_headers.py:290) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2253);setRawHeaders (twisted/web/http_headers.py:222);_encodeName (twisted/web/http_headers.py:112) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);unread_notifs_for_room_id (synapse/handlers/sync.py:953);__exit__ (synapse/util/metrics.py:129) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:458);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);__init__ (synapse/logging/context.py:283) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:454);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_events (synapse/storage/data_stores/main/events_worker.py:225) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:2) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1641);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_room_events_stream_for_rooms (synapse/storage/data_stores/main/stream.py:311);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 3
runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291);deferToThreadPool (twisted/internet/threads.py:55);callInThreadWithCallback (twisted/python/threadpool.py:269);do (twisted/_threads/_team.py:166);do (twisted/_threads/_threadworker.py:114);<lambda> (twisted/_threads/_team.py:166);_coordinateThisTask (twisted/_threads/_team.py:187);do (twisted/_threads/_threadworker.py:57);put (queue.py:151);notify (threading.py:352) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);__exit__ (synapse/logging/context.py:544);set_current_context (synapse/logging/context.py:577);stop (synapse/logging/context.py:403) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:694);on_new_room_event (synapse/notifier.py:238);_notify_pending_new_room_events (synapse/notifier.py:257);_on_new_room_event (synapse/notifier.py:273);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1376);_have_rooms_changed (synapse/handlers/sync.py:1478) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);get_redacted_uri (synapse/http/site.py:92) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_cbDeferred (twisted/internet/defer.py:1121);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);_request_user_agent_is_curl (synapse/http/server.py:557) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 4
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:152) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);runInteraction (synapse/storage/database.py:535);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);runWithConnection (synapse/storage/database.py:583);runWithConnection (twisted/enterprise/adbapi.py:291) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1396);_get_rooms_changed (synapse/handlers/sync.py:1672);__init__ (<attrs generated init synapse.handlers.sync.RoomSyncResultBuilder>:7) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:222) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1891);compute_state_delta (synapse/handlers/sync.py:934);__exit__ (synapse/util/metrics.py:132);labels (prometheus_client/metrics.py:162) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/__init__.py:74);count_listeners (synapse/notifier.py:201);<genexpr> (synapse/notifier.py:201);count_listeners (synapse/notifier.py:125) 1
wait_for_events (synapse/notifier.py:353);timeout_deferred (synapse/util/async_helpers.py:491) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:193) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_state_groups_from_groups_txn (synapse/storage/data_stores/state/bg_updates.py:125);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 2
properties (jsonschema/_validators.py:288);is_type (jsonschema/validators.py:357);is_type (jsonschema/_types.py:95);__getitem__ (pyrsistent/_pmap.py:71);_getitem (pyrsistent/_pmap.py:66) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);dumps (simplejson/__init__.py:395);encode (simplejson/encoder.py:300);iterencode (simplejson/encoder.py:378) 1
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);new_transaction (synapse/storage/database.py:503);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:503);new_transaction (synapse/storage/database.py:503);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_get_unread_counts_by_pos_txn (synapse/storage/data_stores/main/event_push_actions.py:169);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:122);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);untilConcludes (twisted/python/util.py:815);wakeUp (twisted/internet/posixbase.py:181);wakeUp (twisted/internet/base.py:587);callFromThread (twisted/internet/base.py:1032);onResult (twisted/internet/threads.py:51);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);handle (logging/__init__.py:908);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460) 1
_pull (twisted/internet/_producer_helpers.py:81);resumeProducing (twisted/web/static.py:775);write (twisted/web/server.py:275);write (twisted/web/http.py:1159);writeHeaders (twisted/web/http.py:2481);addRawHeader (twisted/web/http_headers.py:242);setRawHeaders (twisted/web/http_headers.py:218) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);__exit__ (synapse/util/metrics.py:121);get_resource_usage (synapse/logging/context.py:413) 1
wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:158);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:86);_handle_record (sentry_sdk/integrations/logging.py:67);handle (logging/__init__.py:905);emit (sentry_sdk/integrations/logging.py:227);_emit (sentry_sdk/integrations/logging.py:235) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);process_request_thread (socketserver.py:650);finish_request (socketserver.py:360);__init__ (socketserver.py:720);handle (http/server.py:426);handle_one_request (http/server.py:414);do_GET (synapse/metrics/_exposition.py:201);generate_latest (synapse/metrics/_exposition.py:108);collect (synapse/metrics/__init__.py:54);collect (prometheus_client/registry.py:75);collect (synapse/metrics/background_process_metrics.py:120);update_metrics (synapse/metrics/background_process_metrics.py:148);get_resource_usage (synapse/logging/context.py:425) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_current_state_ids (synapse/state/__init__.py:173);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);measured_func (synapse/util/metrics.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);resolve_state_groups_for_events (synapse/state/__init__.py:380);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_groups_ids (synapse/storage/state.py:370);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:239) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);makeRecord (logging/__init__.py:1488);__init__ (logging/__init__.py:360);name (threading.py:1061) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1156);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:545);get_entities_changed (synapse/util/caches/stream_change_cache.py:95);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:134) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:900) 1
get_new_events (synapse/handlers/receipts.py:141);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_linearized_receipts_for_rooms (synapse/storage/data_stores/main/receipts.py:145);wrapped (synapse/util/caches/descriptors.py:533);getcallargs (inspect.py:1333);getfullargspec (inspect.py:1126);_signature_from_callable (inspect.py:2238) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:130);_started_processing (synapse/http/site.py:239);start (synapse/http/request_metrics.py:160) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1947) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:901);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:435) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2166);headerReceived (twisted/web/http.py:2253);setRawHeaders (twisted/web/http_headers.py:220);<listcomp> (twisted/web/http_headers.py:220) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);__init__ (twisted/python/failure.py:365) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_pull (twisted/internet/_producer_helpers.py:81);_pull (twisted/internet/_producer_helpers.py:81);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);callback (synapse/util/async_helpers.py:71);_runCallbacks (twisted/internet/defer.py:711);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:401);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416);yieldable_gather_results (synapse/util/async_helpers.py:186);<listcomp> (synapse/util/async_helpers.py:186);run_in_background (synapse/logging/context.py:655);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1421) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 3
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);ephemeral_limit (synapse/api/filtering.py:210) 1
ephemeral_by_room (synapse/handlers/sync.py:417);__exit__ (synapse/util/metrics.py:132);inc (prometheus_client/metrics.py:244) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);filter_room_timeline (synapse/api/filtering.py:228);filter (synapse/api/filtering.py:373);check (synapse/api/filtering.py:319) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);simple_select_many_txn (synapse/storage/database.py:1200);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1853);compute_state_delta (synapse/handlers/sync.py:894);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298) 1
_bootstrap (threading.py:885);_bootstrap_inner (threading.py:917);run (sentry_sdk/integrations/threading.py:67);run (threading.py:865);work (twisted/_threads/_threadworker.py:46);doWork (twisted/_threads/_team.py:190);inContext (twisted/python/threadpool.py:250);<lambda> (twisted/python/threadpool.py:266);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_runWithConnection (twisted/enterprise/adbapi.py:297);inner_func (synapse/storage/database.py:580);new_transaction (synapse/storage/database.py:418);_get_unread_counts_by_receipt_txn (synapse/storage/data_stores/main/event_push_actions.py:114);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:236) 7
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:460);__iter__ (_collections_abc.py:762);__getitem__ (frozendict/__init__.py:29) 13
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:702);_wrapped (synapse/util/caches/descriptors.py:459);succeed (twisted/internet/defer.py:90);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1016);__getattr__ (synapse/config/_base.py:224);_get_unclassed_config (synapse/config/_base.py:244) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);__init__ (twisted/python/failure.py:395) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:255) 11
_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:515);start (twisted/web/static.py:765);registerProducer (twisted/web/http.py:987);registerProducer (twisted/web/http.py:2581);startStreaming (twisted/internet/_producer_helpers.py:90);cooperate (twisted/internet/task.py:753) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1367);ephemeral_by_room (synapse/handlers/sync.py:407);copy_and_replace (synapse/types.py:409);_replace (collections/__init__.py:414) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1416);throwExceptionIntoGenerator (twisted/python/failure.py:512);wait_for_events (synapse/notifier.py:373);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1030);_wrapped (synapse/util/caches/descriptors.py:438);get_cache_key (synapse/util/caches/descriptors.py:422) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);prefill (synapse/util/caches/descriptors.py:225);inner (synapse/util/caches/lrucache.py:97);cache_set (synapse/util/caches/lrucache.py:190) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);iter_errors (jsonschema/validators.py:341);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:217);update_metrics (synapse/metrics/background_process_metrics.py:156) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1876);compute_summary (synapse/handlers/sync.py:629);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_event (synapse/storage/state.py:525);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_ids_for_events (synapse/storage/state.py:486);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:179);get (synapse/util/caches/dictionary_cache.py:89) 6
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);time_it_out (synapse/util/async_helpers.py:456);cancel (twisted/internet/defer.py:545);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);failure_cb (synapse/util/async_helpers.py:487);errback (twisted/internet/defer.py:501);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:335);_send_response (synapse/http/server.py:380);respond_with_json (synapse/http/server.py:483);respond_with_json_bytes (synapse/http/server.py:502);setHeader (twisted/web/http.py:1314);setRawHeaders (twisted/web/http_headers.py:218);_sanitizeLinearWhitespace (twisted/web/http_headers.py:40) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);fire (synapse/storage/data_stores/main/events_worker.py:511);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);handle_room_entries (synapse/handlers/sync.py:1416) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:583);lineReceived (twisted/web/http.py:2167);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:237);render (synapse/http/site.py:138);render (twisted/web/server.py:358);render (synapse/http/server.py:304);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);check_auth_blocking (synapse/api/auth.py:694);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:154);inner (synapse/util/caches/lrucache.py:97);cache_get (synapse/util/caches/lrucache.py:157) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);f (synapse/metrics/__init__.py:473);runUntilCurrent (twisted/internet/base.py:935);_tick (twisted/internet/task.py:672);_oneWorkUnit (twisted/internet/task.py:528);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:305);stop (synapse/http/request_metrics.py:213);labels (prometheus_client/metrics.py:162) 1
get_state_for_events (synapse/storage/state.py:445);wrapped (synapse/util/caches/descriptors.py:620);gatherResults (twisted/internet/defer.py:1183);__init__ (twisted/internet/defer.py:1081) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/protocols/basic.py:454);lineReceived (synapse/replication/tcp/protocol.py:237);run_as_background_process (synapse/metrics/background_process_metrics.py:223);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);run (synapse/metrics/background_process_metrics.py:211);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);handle_command (synapse/replication/tcp/protocol.py:263);on_RDATA (synapse/replication/tcp/handler.py:281);on_rdata (synapse/replication/tcp/handler.py:293);on_rdata (synapse/app/generic_worker.py:659);process_and_notify (synapse/app/generic_worker.py:716);on_new_event (synapse/notifier.py:303);notify (synapse/notifier.py:111);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);success_cb (synapse/util/async_helpers.py:483);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:988);get_rooms_for_user_at (synapse/handlers/sync.py:1948) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:321);_get_handler_for_request (synapse/http/server.py:361) 1
_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1181);get_users_whose_devices_changed (synapse/storage/data_stores/main/devices.py:549);get_entities_changed (synapse/util/caches/stream_change_cache.py:103);get_all_entities_changed (synapse/util/caches/stream_change_cache.py:135) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);new_transaction (synapse/storage/database.py:503);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);wait_for_sync_for_user (synapse/handlers/sync.py:291);_async_render (synapse/http/server.py:335);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);f (synapse/storage/data_stores/main/stream.py:402);_do_execute (synapse/storage/database.py:243);execute (synapse/storage/database.py:210);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);get_room_events_stream_for_room (synapse/storage/data_stores/main/stream.py:422);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);get_room_events_stream_for_room (synapse/storage/data_stores/main/stream.py:422);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);get_room_events_stream_for_room (synapse/storage/data_stores/main/stream.py:422);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);get_room_events_stream_for_room (synapse/storage/data_stores/main/stream.py:422);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:628) 1
_inlineCallbacks (twisted/internet/defer.py:1483);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1483);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1483);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);on_rdata (synapse/app/generic_worker.py:659);on_rdata (synapse/replication/tcp/handler.py:293);_ctx_manager (synapse/util/async_helpers.py:270);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);process_and_notify (synapse/app/generic_worker.py:742);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);_inlineCallbacks (twisted/internet/defer.py:1422);_cancellableInlineCallbacks (twisted/internet/defer.py:1530);unwindGenerator (twisted/internet/defer.py:1613);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_async_render (synapse/http/server.py:335);wrapped_request_handler (synapse/http/server.py:127);processing (synapse/http/site.py:173);wrapped_async_request_handler (synapse/http/server.py:209);_inlineCallbacks (twisted/internet/defer.py:1422);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_cbDeferred (twisted/internet/defer.py:1121);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);_runCallbacks (twisted/internet/defer.py:711);_startRunCallbacks (twisted/internet/defer.py:568);callback (twisted/internet/defer.py:460);_inlineCallbacks (twisted/internet/defer.py:1422);gotResult (twisted/internet/defer.py:1475);inner_func (synapse/storage/database.py:580);_runWithConnection (twisted/enterprise/adbapi.py:299);callWithContext (twisted/python/context.py:87);callWithContext (twisted/python/context.py:122);<lambda> (twisted/python/threadpool.py:266);inContext (twisted/python/threadpool.py:261);_inlineCallbacks (twisted/internet/defer.py:1422);addBoth (twisted/internet/defer.py:345);addCallbacks (twisted/internet/defer.py:312);_runCallbacks (twisted/internet/defer.py:627) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:894);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1422);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:711);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:183);encode_response (synapse/rest/client/v2_alpha/sync.py:201);encode_joined (synapse/rest/client/v2_alpha/sync.py:278);encode_room (synapse/rest/client/v2_alpha/sync.py:400);serialize (synapse/rest/client/v2_alpha/sync.py:381);serialize_events (synapse/events/utils.py:416) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1033);measured_func (synapse/util/metrics.py:73);__enter__ (synapse/util/metrics.py:114);__init__ (synapse/logging/context.py:283) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:536) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:153);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1034);format (logging/__init__.py:880);format (logging/__init__.py:621) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:913);_tick (twisted/internet/task.py:671);_oneWorkUnit (twisted/internet/task.py:517);_pull (twisted/internet/_producer_helpers.py:66);resumeProducing (twisted/web/static.py:778);finish (synapse/http/site.py:185);_finished_processing (synapse/http/site.py:301);info (logging/__init__.py:1383);_log (logging/__init__.py:1519);handle (logging/__init__.py:1529);sentry_patched_callhandlers (sentry_sdk/integrations/logging.py:77);callHandlers (logging/__init__.py:1591);handle (logging/__init__.py:905);emit (logging/handlers.py:1234);flush (logging/handlers.py:1310);handle (logging/__init__.py:905);emit (logging/__init__.py:1132);emit (logging/__init__.py:1038);format (logging/__init__.py:880);format (logging/__init__.py:636);getMessage (logging/__init__.py:380) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2101);resetTimeout (twisted/protocols/policies.py:713) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:235);render (synapse/http/site.py:132);render (twisted/web/server.py:302);render (synapse/http/server.py:303);g (synapse/logging/context.py:616);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);wrapped_async_request_handler (synapse/http/server.py:209);wrapped_request_handler (synapse/http/server.py:78);_async_render (synapse/http/server.py:331);on_GET (synapse/rest/client/v2_alpha/sync.py:178);wait_for_sync_for_user (synapse/handlers/sync.py:289);wrap (synapse/util/caches/response_cache.py:150);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73);_generate_sync_entry_for_device_list (synapse/handlers/sync.py:1149) 8
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1806);_load_filtered_recents (synapse/handlers/sync.py:466);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);filter_events_for_client (synapse/visibility.py:82);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:258) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:315);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1023);measured_func (synapse/util/metrics.py:73) 2
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);_wait_for_sync_for_user (synapse/handlers/sync.py:326);wait_for_events (synapse/notifier.py:357);current_sync_for_user (synapse/handlers/sync.py:346);generate_sync_result (synapse/handlers/sync.py:1003);_generate_sync_entry_for_rooms (synapse/handlers/sync.py:1422);concurrently_execute (synapse/util/async_helpers.py:165);<listcomp> (synapse/util/async_helpers.py:165);run_in_background (synapse/logging/context.py:647);ensureDeferred (twisted/internet/defer.py:911);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_concurrently_execute_inner (synapse/util/async_helpers.py:159);_generate_room_entry (synapse/handlers/sync.py:1892);unread_notifs_for_room_id (synapse/handlers/sync.py:951);_wrapped (synapse/util/caches/descriptors.py:459);get (synapse/util/caches/descriptors.py:151) 1
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1292);f (synapse/metrics/__init__.py:436);runUntilCurrent (twisted/internet/base.py:886);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1421);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);complete_all (synapse/util/caches/descriptors.py:592);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);callback (synapse/util/async_helpers.py:68);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);_cbDeferred (twisted/internet/defer.py:1116);callback (twisted/internet/defer.py:460);_startRunCallbacks (twisted/internet/defer.py:568);_runCallbacks (twisted/internet/defer.py:654);gotResult (twisted/internet/defer.py:1475);_inlineCallbacks (twisted/internet/defer.py:1418);get_state_for_events (synapse/storage/state.py:449);unwindGenerator (twisted/internet/defer.py:1613);_cancellableInlineCallbacks (twisted/internet/defer.py:1529);_inlineCallbacks (twisted/internet/defer.py:1418);_get_state_for_groups (synapse/storage/data_stores/state/store.py:234);_get_state_for_groups_using_cache (synapse/storage/data_stores/state/store.py:298);_get_state_for_group_using_cache (synapse/storage/data_stores/state/store.py:184);filter_state (synapse/storage/state.py:257) 4
_run_module_as_main (runpy.py:193);_run_code (runpy.py:85);<module> (synapse/app/synchrotron.py:24);start (synapse/app/generic_worker.py:983);start_worker_reactor (synapse/app/_base.py:77);start_reactor (synapse/app/_base.py:137);start (daemonize.py:248);run (synapse/app/_base.py:114);run (twisted/internet/base.py:1283);mainLoop (twisted/internet/base.py:1295);doPoll (twisted/internet/epollreactor.py:235);callWithLogger (twisted/python/log.py:103);callWithContext (twisted/python/log.py:86);callWithContext (twisted/python/context.py:122);callWithContext (twisted/python/context.py:85);_doReadOrWrite (twisted/internet/posixbase.py:614);doRead (twisted/internet/tcp.py:243);_dataReceived (twisted/internet/tcp.py:249);dataReceived (twisted/web/http.py:3024);dataReceived (twisted/web/http.py:2305);dataReceived (twisted/protocols/basic.py:572);lineReceived (twisted/web/http.py:2155);allContentReceived (twisted/web/http.py:2284);requestReceived (twisted/web/http.py:946);process (twisted/web/server.py:231);getResourceFor (twisted/web/server.py:898) 1
